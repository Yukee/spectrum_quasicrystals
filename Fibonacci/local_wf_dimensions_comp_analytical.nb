(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     95944,       2432]
NotebookOptionsPosition[     93299,       2343]
NotebookOutlinePosition[     93634,       2358]
CellTagsIndexPosition[     93591,       2355]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Styling", "Section",
 CellChangeTimes->{{3.650529670445614*^9, 3.650529671387044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dir", "=", 
  RowBox[{"NotebookDirectory", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.621746080389682*^9, 3.62174608226017*^9}, {
  3.621746135693265*^9, 3.621746138092404*^9}, {3.621746173598854*^9, 
  3.621746176545178*^9}, {3.621746380188685*^9, 3.621746380796864*^9}}],

Cell[BoxData["\<\"/home/nicolas/git/spectrum_quasicrystals/Fibonacci/\"\>"], \
"Output",
 CellChangeTimes->{
  3.621746138720299*^9, 3.6217461772329283`*^9, 3.6217463820837097`*^9, 
   3.621914084597064*^9, 3.622354902377564*^9, 3.6224500465525513`*^9, 
   3.623673817987068*^9, {3.623732923752467*^9, 3.6237329431664143`*^9}, 
   3.623733011172534*^9, 3.6265009345731573`*^9, 3.626503064282505*^9, 
   3.626518136823456*^9, 3.6265986644273252`*^9, 3.626766190657977*^9, 
   3.6267758308974867`*^9, 3.626942336671768*^9, 3.6297104411821547`*^9, 
   3.629712724622324*^9, 3.629781022135947*^9, 3.630046408966426*^9, 
   3.6313337238449497`*^9, 3.631354144526745*^9, 3.631354355972702*^9, 
   3.6314232172648153`*^9, 3.63671596736003*^9, 3.637648354158971*^9, 
   3.637655444542446*^9, 3.638266550188231*^9, 3.6386965559831057`*^9, 
   3.649669983893663*^9, 3.649670056491778*^9, 3.650529695356668*^9, 
   3.6505341494579573`*^9, 3.650718391279537*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Thickness", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"th", "=", "0.003"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.621748603657528*^9, 3.621748631317513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Styling", " ", "of", " ", "the", " ", "text"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"st", "=", 
     RowBox[{"Directive", "[", 
      RowBox[{"Large", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Linux Libertine Display\>\""}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stylize", "[", "text_", "]"}], ":=", 
     RowBox[{"Style", "[", 
      RowBox[{"text", ",", "st"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.649669976732336*^9, 3.649669979410515*^9}, {
  3.650534116404479*^9, 3.650534130111813*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BostonBlue", "=", 
   RowBox[{"RGBColor", "[", "\"\<#00688B\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"comp", "=", 
   RowBox[{"RGBColor", "[", "\"\<#8B2300\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6496703258985233`*^9, 3.649670325915792*^9}, {
  3.649670489172563*^9, 3.6496705180944643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Style", "[", 
  RowBox[{
   RowBox[{"Text", "[", "\"\<caca\>\"", "]"}], ",", "BostonBlue"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6496705218533*^9, 3.649670536292047*^9}}],

Cell[BoxData[
 StyleBox[
  InterpretationBox[Cell[BoxData[
    FormBox["\<\"caca\"\>", TextForm]], "InlineText"],
   Text["caca"]],
  StripOnInput->False,
  LineColor->RGBColor[0., 0.40784313725490196`, 0.5450980392156862],
  FrontFaceColor->RGBColor[0., 0.40784313725490196`, 0.5450980392156862],
  BackFaceColor->RGBColor[0., 0.40784313725490196`, 0.5450980392156862],
  GraphicsColor->RGBColor[0., 0.40784313725490196`, 0.5450980392156862],
  FontColor->RGBColor[
   0., 0.40784313725490196`, 0.5450980392156862]]], "Output",
 CellChangeTimes->{
  3.6496705366879787`*^9, 3.6505296954274397`*^9, {3.6505341326848087`*^9, 
   3.65053414248067*^9}, 3.6507183914281054`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hamiltonians", "Section",
 CellChangeTimes->{{3.629712555829027*^9, 3.629712557652924*^9}, {
  3.650529701640504*^9, 3.650529711404598*^9}}],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.632041721549465*^9, 3.632041723101447*^9}, {
  3.6358312356676207`*^9, 3.635831252179337*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fibonacci", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{
     RowBox[{"in", " ", "the", " ", "co"}], "-", "basis"}], ",", " ", 
    RowBox[{"with", " ", "periodic", " ", "bc"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"hp", "[", 
    RowBox[{"n_", ",", "tw_", ",", "ts_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F0", "=", 
        RowBox[{"Fibonacci", "[", "n", "]"}]}], ",", 
       RowBox[{"F1", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], ",", 
       RowBox[{"F2", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "2"}], "]"}]}], ",", "tblw", ",", "tbls", ",", 
       "ar"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tblw", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F0"}]}], "}"}], "\[Rule]", "tw"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "F1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbls", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F1"}]}], "}"}], "\[Rule]", "ts"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "F0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ar", "=", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"tblw", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}], "+", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"tbls", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Normal", "[", 
       RowBox[{"ar", "+", 
        RowBox[{"Transpose", "[", "ar", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.626500989913364*^9, 3.6265010439825687`*^9}, {
   3.6265010838140287`*^9, 3.6265011556879473`*^9}, {3.626501188073691*^9, 
   3.626501251376388*^9}, {3.626501282361532*^9, 3.626501308767273*^9}, {
   3.6265013837286673`*^9, 3.626501388405682*^9}, {3.6297117308094873`*^9, 
   3.629711744441989*^9}, {3.629712260739542*^9, 3.6297122613888474`*^9}, {
   3.629712372304244*^9, 3.629712372429983*^9}, 3.6313353026608963`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fibonacci", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{
     RowBox[{"in", " ", "the", " ", "co"}], "-", "basis"}], ",", " ", 
    RowBox[{"with", " ", "antiperiodic", " ", "bc"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ha", "[", 
    RowBox[{"n_", ",", "tw_", ",", "ts_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F0", "=", 
        RowBox[{"Fibonacci", "[", "n", "]"}]}], ",", 
       RowBox[{"F1", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], ",", 
       RowBox[{"F2", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "2"}], "]"}]}], ",", "tblw", ",", "tbls", ",", 
       "ar"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tblw", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F0"}]}], "}"}], "\[Rule]", "tw"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "F1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbls", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F1"}]}], "}"}], "\[Rule]", "ts"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "F0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"tblw", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"1", "+", "F0"}]}], "}"}], "\[Rule]", 
         RowBox[{"-", "tw"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ar", "=", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"tblw", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}], "+", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"tbls", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Normal", "[", 
       RowBox[{"ar", "+", 
        RowBox[{"Transpose", "[", "ar", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.626500989913364*^9, 3.6265010439825687`*^9}, {
  3.6265010838140287`*^9, 3.6265011556879473`*^9}, {3.626501188073691*^9, 
  3.626501251376388*^9}, {3.626501282361532*^9, 3.626501308767273*^9}, {
  3.6265013837286673`*^9, 3.626501388405682*^9}, {3.6297117308094873`*^9, 
  3.629711744441989*^9}, {3.629712260739542*^9, 3.629712288374743*^9}, {
  3.6297123335518017`*^9, 3.629712368126628*^9}, {3.62971244612885*^9, 
  3.6297124945286303`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fibonacci", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{
     RowBox[{"in", " ", "the", " ", "co"}], "-", "basis"}], ",", " ", 
    RowBox[{"with", " ", 
     SuperscriptBox["e", "ik"], " ", "bc"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"hk", "[", 
    RowBox[{"k_", ",", "n_", ",", "tw_", ",", "ts_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F0", "=", 
        RowBox[{"Fibonacci", "[", "n", "]"}]}], ",", 
       RowBox[{"F1", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "1"}], "]"}]}], ",", 
       RowBox[{"F2", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "2"}], "]"}]}], ",", "tblw", ",", "tbls", ",", 
       "ar"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tblw", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F0"}]}], "}"}], "\[Rule]", "tw"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", "F1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbls", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F1"}]}], "}"}], "\[Rule]", "ts"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "F0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PrependTo", "[", 
       RowBox[{"tblw", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"1", "+", "F0"}]}], "}"}], "\[Rule]", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "k"}], "]"}], "tw"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ar", "=", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"tblw", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}], "+", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"tbls", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Normal", "[", 
       RowBox[{"ar", "+", 
        RowBox[{"ConjugateTranspose", "[", "ar", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.626500989913364*^9, 3.6265010439825687`*^9}, {
  3.6265010838140287`*^9, 3.6265011556879473`*^9}, {3.626501188073691*^9, 
  3.626501251376388*^9}, {3.626501282361532*^9, 3.626501308767273*^9}, {
  3.6265013837286673`*^9, 3.626501388405682*^9}, {3.6297117308094873`*^9, 
  3.629711744441989*^9}, {3.629712260739542*^9, 3.629712288374743*^9}, {
  3.6297123335518017`*^9, 3.629712368126628*^9}, {3.62971244612885*^9, 
  3.6297124945286303`*^9}, {3.6342799382942677`*^9, 3.6342799433882017`*^9}, {
  3.634279999836821*^9, 3.6342800047344503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fibonacci", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", "normal", " ", "basis"}], ",", " ", 
    RowBox[{"with", " ", "free", " ", "bc"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]", "=", 
     RowBox[{"N", " ", "[", 
      FractionBox[
       RowBox[{
        RowBox[{"Sqrt", "[", "5", "]"}], "-", "1"}], "2"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rot", "=", "28"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "rotate", " ", "the", " ", "sequence", " ", "of", " ", "couplings"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fib", "[", "n_", "]"}], ":=", 
     RowBox[{
      RowBox[{"IntegerPart", "[", 
       RowBox[{"\[Omega]", 
        RowBox[{"(", " ", 
         RowBox[{"n", "+", "1", "+", "rot"}], ")"}]}], "]"}], "-", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{"\[Omega]", " ", 
        RowBox[{"(", 
         RowBox[{"n", "+", "rot"}], ")"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"jump", "[", 
      RowBox[{"n_", ",", "tw_", ",", "ts_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fib", "[", 
         RowBox[{"n", "-", "1"}], "]"}], "<", "1"}], ",", "ts", ",", "tw"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hf", "[", 
     RowBox[{"n_", ",", "tw_", ",", "ts_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F2", "=", 
         RowBox[{"Fibonacci", "[", 
          RowBox[{"n", "+", "2"}], "]"}]}], ",", "tbl", ",", "ar"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tbl", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
           RowBox[{"jump", "[", 
            RowBox[{"i", ",", "tw", ",", "ts"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"F2", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ar", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"tbl", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{"ar", "+", 
         RowBox[{"Transpose", "[", "ar", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.631333750117631*^9, 3.631333766565724*^9}, {
  3.631333881332066*^9, 3.6313339868274307`*^9}, {3.6313340216815977`*^9, 
  3.631334026761477*^9}, {3.631334111921028*^9, 3.6313341148624983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fibonacci", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{"in", " ", "the", " ", "normal", " ", "basis"}], ",", " ", 
    RowBox[{"with", " ", "periodic", " ", "bc"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"hpn", "[", 
    RowBox[{"n_", ",", "tw_", ",", "ts_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F2", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "+", "2"}], "]"}]}], ",", "tbl", ",", "ar"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tbl", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
          RowBox[{"jump", "[", 
           RowBox[{"i", ",", "tw", ",", "ts"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"F2", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"tbl", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "F2"}], "}"}], "\[Rule]", "tw"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ar", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"tbl", ",", 
         RowBox[{"{", 
          RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Normal", "[", 
       RowBox[{"ar", "+", 
        RowBox[{"Transpose", "[", "ar", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.631333750117631*^9, 3.631333766565724*^9}, {
  3.631333881332066*^9, 3.6313339868274307`*^9}, {3.6313340216815977`*^9, 
  3.631334026761477*^9}, {3.631334111921028*^9, 3.6313341148624983`*^9}, {
  3.6313347078403673`*^9, 3.631334724799961*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Harper", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hharp", "[", 
     RowBox[{"p_", ",", "q_", ",", "\[Phi]_", ",", "\[Lambda]_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hopping", ",", "pot"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"hopping", " ", "subdiagonal", " ", "part"}], "*)"}], 
      RowBox[{
       RowBox[{"hopping", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
           RowBox[{"-", "1."}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"q", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"periodic", " ", "boundary", " ", "conditions"}], "*)"}], 
       RowBox[{"AppendTo", "[", 
        RowBox[{"hopping", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "q"}], "}"}], "\[Rule]", 
          RowBox[{"-", "1."}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"convert", " ", "to", " ", "matrix"}], "*)"}], 
       RowBox[{"hopping", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"hopping", ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "q"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "symmetrize", "*)"}], 
       RowBox[{"hopping", "=", 
        RowBox[{"hopping", "+", 
         RowBox[{"Transpose", "[", "hopping", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"diagonal", " ", "part"}], "*)"}], 
       RowBox[{"pot", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "i"}], "}"}], "\[Rule]", 
             RowBox[{"2.", "\[Lambda]", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"2", " ", "\[Pi]", " ", "p", " ", 
                 RowBox[{"i", "/", "q"}]}], "+", "\[Phi]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "q"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "q"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{"pot", "+", "hopping"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "choosing", " ", "Fibonacci", " ", "numbers", " ", "as", " ", 
     "approximants"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"hfib", "[", 
      RowBox[{"n_", ",", "\[Phi]_", ",", "\[Lambda]_"}], "]"}], ":=", 
     RowBox[{"hharp", "[", 
      RowBox[{
       RowBox[{"Fibonacci", "[", 
        RowBox[{"n", "-", "1"}], "]"}], ",", 
       RowBox[{"Fibonacci", "[", "n", "]"}], ",", "\[Phi]", ",", 
       "\[Lambda]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"hfib", ",", "Listable"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.638249400809607*^9, 3.638249432782072*^9}, {
  3.638249651446948*^9, 3.6382496950248528`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wavefunctions", "Section",
 CellChangeTimes->{{3.6505299538228807`*^9, 3.650529958121068*^9}}],

Cell[CellGroupData[{

Cell["Wavefunctions: definitions.", "Subsection",
 CellChangeTimes->{{3.630934451760487*^9, 3.63093445745586*^9}, {
  3.650529960455673*^9, 3.6505299613584337`*^9}}],

Cell["\<\
We define general functions computing fractal dimensions from lists, rather \
than functions adapted to our specific case.\
\>", "Text",
 CellChangeTimes->{{3.6309975019888783`*^9, 3.630997549157268*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[TextData[{
 "We compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Chi]", "q"], "n"], "(", "i", ")"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", "a"], "|", 
     RowBox[{
      SuperscriptBox["\[Psi]", "n"], "(", 
      RowBox[{"i", ",", "a"}], ")"}], 
     SuperscriptBox["|", 
      RowBox[{"2", "q"}]]}]}], TraditionalForm]]],
 ".\nWe define the local dimension of the wavefunctions:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["D", "q"], "(", "i", ")"}], "=", 
    RowBox[{
     SubscriptBox["lim", 
      RowBox[{"n", "\[Rule]", "\[Infinity]"}]], 
     RowBox[{
      FractionBox["1", 
       RowBox[{"q", "-", "1"}]], 
      FractionBox[
       RowBox[{"log", "(", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Chi]", "q"], "n"], "(", "i", ")"}], ")"}], 
       RowBox[{"log", "(", 
        RowBox[{"1", "/", 
         SubscriptBox["F", "n"]}], ")"}]]}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6297819505151176`*^9, 3.629782150655591*^9}, {
  3.6303260562655563`*^9, 3.630326139818005*^9}, {3.630934477152502*^9, 
  3.630934567217009*^9}, {3.630934630673167*^9, 3.630934631297505*^9}, {
  3.6309354307593203`*^9, 3.630935516815362*^9}, {3.6309356538549843`*^9, 
  3.630935654575048*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "wf", " ", "is", " ", "a", " ", "list", " ", "of", " ", "numbers", " ", 
     "that", " ", "are", " ", "a", " ", "priori", " ", "the", " ", 
     "coefficients", " ", "of", " ", "a", " ", 
     RowBox[{"wavefunction", ".", " ", "They"}], " ", "can", " ", "be", " ", 
     "coefficients", " ", "in", " ", "the", " ", "position", " ", "basis"}], 
    ",", " ", 
    RowBox[{"for", " ", "a", " ", "given", " ", "energy"}], ",", " ", 
    RowBox[{
    "or", " ", "coefficients", " ", "in", " ", "the", " ", "energy", " ", 
     "basis", " ", "for", " ", "a", " ", "particular", " ", 
     RowBox[{"position", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"WfD", "[", 
    RowBox[{"wf_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"q", "-", "1"}], ")"}], 
      RowBox[{"-", "1"}]]}], 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"Plus", "@@", 
       SuperscriptBox[
        RowBox[{"Abs", "[", "wf", "]"}], 
        RowBox[{"2", "q"}]]}], "]"}], 
     RowBox[{"Log", "[", 
      RowBox[{"Length", "@", "wf"}], "]"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.630997267210726*^9, 3.630997456587614*^9}, {
  3.630997567916525*^9, 3.630997642602827*^9}, {3.6313445925282907`*^9, 
  3.631344626817724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "a", " ", "more", " ", "precise", " ", "way", " ", "of", " ", "computing",
      " ", "the", " ", "dimensions"}], ",", " ", 
    RowBox[{
    "using", " ", "data", " ", "from", " ", "two", " ", "systems", " ", "of", 
     " ", "consecutive", " ", "size"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"tauqxloc", "[", 
     RowBox[{"int_", ",", "intN_", ",", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Log", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Total", "@", 
          RowBox[{"(", 
           RowBox[{"int", "^", "q"}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"Total", "@", 
          RowBox[{"(", 
           RowBox[{"intN", "^", "q"}], ")"}]}], ")"}]}], "]"}]}], "/", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Length", "@", "int"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"Length", "@", "intN"}], ")"}]}], "]"}]}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.638596075723093*^9, 3.638596124392284*^9}}],

Cell[TextData[{
 "We compute the partition function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[CapitalGamma]", 
       RowBox[{"\[Tau]", ",", "q"}]], "n"], "(", "i", ")"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalSigma]", "a"], 
     FractionBox[
      RowBox[{"|", 
       RowBox[{
        SuperscriptBox["\[Psi]", "n"], 
        RowBox[{"(", 
         RowBox[{"i", ",", "a"}], ")"}]}], 
       SuperscriptBox["|", 
        RowBox[{"2", "q"}]]}], 
      SuperscriptBox[
       RowBox[{"(", 
        SuperscriptBox[
         SubscriptBox["\[CapitalDelta]", "a"], "n"], ")"}], "\[Tau]"]]}]}], 
   TraditionalForm]]],
 ".\nWe define the local dimension of the wavefunctions:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Tau]", "i"], "(", "q", ")"}], " ", "such", " ", "that", 
     " ", 
     RowBox[{
      SubscriptBox["lim", 
       RowBox[{"n", "\[Rule]", "\[Infinity]"}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[CapitalGamma]", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Tau]", "i"], "(", "q", ")"}], ",", "q"}]], 
         RowBox[{"n", "+", "1"}]], "(", "i", ")"}], 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["\[CapitalGamma]", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Tau]", "i"], "(", "q", ")"}], ",", "q"}]], "n"], 
        "(", "i", ")"}]]}]}], "=", "1"}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.6297819505151176`*^9, 3.629782150655591*^9}, {
  3.6303260562655563`*^9, 3.630326139818005*^9}, {3.630934477152502*^9, 
  3.630934567217009*^9}, {3.630934630673167*^9, 3.630934631297505*^9}, {
  3.6309354307593203`*^9, 3.630935667729848*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"compute", " ", "fractal", " ", "dimension", " ", 
     SubscriptBox["D", "q"], " ", "from", " ", "2", " ", "lists", " ", "of", 
     " ", "weights", " ", "and", " ", "box", " ", "lengths"}], ",", " ", 
    RowBox[{"using", " ", "the", " ", "thermodynamic", " ", "formalism"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PartD", "[", 
    RowBox[{
    "weights_", ",", "weightsN_", ",", "lengths_", ",", "lengthsN_", ",", 
     "q_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gam", ",", "gamN", ",", "\[Tau]", ",", "\[Tau]0", ",", "q0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gam", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", "weights", ")"}], "q0"], 
          SuperscriptBox[
           RowBox[{"(", "lengths", ")"}], 
           RowBox[{"-", "\[Tau]"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"gamN", "=", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", "weightsN", ")"}], "q0"], 
          SuperscriptBox[
           RowBox[{"(", "lengthsN", ")"}], 
           RowBox[{"-", "\[Tau]"}]]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       SubscriptBox["D", "q"], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Tau]0", "=", 
       RowBox[{"\[Tau]", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["gamN", "gam"], "/.", 
             RowBox[{"q0", "\[Rule]", "q"}]}], ")"}], "-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Tau]", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      FractionBox["\[Tau]0", 
       RowBox[{"q", "-", "1"}]]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.630997864395117*^9, 3.630997940972649*^9}, {
   3.630998058701036*^9, 3.630998151711904*^9}, {3.6309981817454863`*^9, 
   3.6309983368371696`*^9}, 3.630998958714292*^9, {3.630999209213921*^9, 
   3.630999246524372*^9}, {3.632048811113677*^9, 3.632048811171896*^9}, 
   3.632048900297194*^9}],

Cell[CellGroupData[{

Cell["Tree structure", "Subsubsection",
 CellChangeTimes->{{3.632042006415544*^9, 3.632042008959408*^9}, {
  3.6505334056990423`*^9, 3.6505334069834146`*^9}}],

Cell[TextData[{
 "After a renormalization step, a given site i of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]]],
 " approximant becomes either molecular (in which case n becomes n-2) or \
atomic (n becomes n-3). \nWe can thus associate to each site a unique \
\[OpenCurlyDoubleQuote]renormalization path\[CloseCurlyDoubleQuote]: the \
sequence of molecular/atomic sites that has led to it, starting from the \
trivial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["F", "n"], "=", "1"}], ")"}], TraditionalForm]]],
 " chain and inflating it.\n\nMore details in the \
\[OpenCurlyDoubleQuote]renormalization_path.nb\[CloseCurlyDoubleQuote] file."
}], "Text",
 CellChangeTimes->{{3.631365638464468*^9, 3.6313658553137217`*^9}, {
  3.631365896018684*^9, 3.6313659003057003`*^9}, {3.631426761322414*^9, 
  3.6314267847002087`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"take", " ", "a", " ", "renormalization", " ", "path", " ", 
     RowBox[{"(", "seq", ")"}]}], ",", " ", 
    RowBox[{"a", " ", "site", " ", "label", " ", 
     RowBox[{"(", "i", ")"}], " ", "and", " ", "an", " ", "approximant", " ", 
     "size", " ", 
     RowBox[{"(", "n", ")"}], " ", "and", " ", "return", " ", "the", " ", 
     "new", " ", "renormalization", " ", "path"}], ",", " ", 
    RowBox[{
    "the", " ", "new", " ", "site", " ", "label", " ", "and", " ", "the", " ",
      "new", " ", "size", " ", "after", " ", "one", " ", "renormalization", 
     " ", "group", " ", "operation"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"i", ",", "n"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iterSeq", "[", 
     RowBox[{"{", 
      RowBox[{"seq_", ",", "i_", ",", "n_"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"inew", "=", "i"}], ",", 
        RowBox[{"seqn", "=", "seq"}], ",", 
        RowBox[{"nnew", "=", "n"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", 
          RowBox[{"Fibonacci", "[", 
           RowBox[{"n", "-", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"seqn", "=", 
           RowBox[{"\"\<m\>\"", "<>", "seq"}]}], ";", 
          RowBox[{"inew", "=", 
           RowBox[{"i", "-", 
            RowBox[{"Fibonacci", "[", 
             RowBox[{"n", "-", "1"}], "]"}]}]}], ";", 
          RowBox[{"nnew", "=", 
           RowBox[{"n", "-", "2"}]}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", 
            RowBox[{"Fibonacci", "[", 
             RowBox[{"n", "-", "2"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"seqn", "=", 
             RowBox[{"\"\<a\>\"", "<>", "seq"}]}], ";", 
            RowBox[{"inew", "=", 
             RowBox[{"i", "-", 
              RowBox[{"Fibonacci", "[", 
               RowBox[{"n", "-", "2"}], "]"}]}]}], ";", 
            RowBox[{"nnew", "=", 
             RowBox[{"n", "-", "3"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"seqn", "=", 
             RowBox[{"\"\<m\>\"", "<>", "seq"}]}], ";", 
            RowBox[{"nnew", "=", 
             RowBox[{"n", "-", "2"}]}], ";"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"seqn", ",", "inew", ",", "nnew"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"false", " ", "when", " ", "n"}], "<", "3"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[GreaterEqual]", "3"}], "&"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"take", " ", "a", " ", "site", " ", 
      RowBox[{"(", "i", ")"}]}], ",", " ", 
     RowBox[{"a", " ", "size", " ", 
      RowBox[{"(", "n", ")"}], " ", "and", " ", "return", " ", "the", " ", 
      "renormalization", " ", "path", " ", "for", " ", "this", " ", 
      "site"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"path", "[", 
     RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"NestWhile", "[", 
       RowBox[{"iterSeq", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<\>\"", ",", "i", ",", "n"}], "}"}], ",", "test"}], 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "i"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "compute", " ", "the", " ", "relative", " ", "time", " ", "spent", " ", 
     "on", " ", "molecular", " ", "sites", " ", 
     RowBox[{"(", "x", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xPath", "[", 
     RowBox[{"i_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"StringCount", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NestWhile", "[", 
           RowBox[{"iterSeq", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<\>\"", ",", "i", ",", "n"}], "}"}], ",", "test"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<m\>\""}], "]"}], "/", 
       "n"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"generate", " ", "the", " ", "whole", " ", 
     RowBox[{"(", "x", ")"}], " ", 
     RowBox[{"tree", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tree", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"xPath", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], "/@", " ", 
     RowBox[{"Range", "[", 
      RowBox[{"Fibonacci", "[", "n", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6313589574343977`*^9, 3.6313590302798233`*^9}, {
   3.631359076279845*^9, 3.6313593102066603`*^9}, {3.631359391471822*^9, 
   3.6313594047194157`*^9}, {3.6313594593282537`*^9, 3.631359462513579*^9}, {
   3.6313595010407*^9, 3.631359521955605*^9}, {3.631359596818037*^9, 
   3.631359606915451*^9}, {3.631359651491734*^9, 3.6313596831724777`*^9}, {
   3.6313634417688093`*^9, 3.631363482904171*^9}, {3.631364258193778*^9, 
   3.631364318864571*^9}, {3.6313647703411922`*^9, 3.63136477755731*^9}, {
   3.6313648216112947`*^9, 3.631364823625928*^9}, {3.631364880726359*^9, 
   3.631364887510838*^9}, {3.631364979383456*^9, 3.631365063114964*^9}, 
   3.631365189625307*^9, {3.631365920448059*^9, 3.6313659926244802`*^9}, {
   3.631426798788385*^9, 3.631426807777585*^9}, {3.631430687105792*^9, 
   3.631430691090613*^9}, 3.631516490573141*^9, {3.632049521570463*^9, 
   3.632049521680777*^9}, 3.632055040279293*^9, {3.6320551561537037`*^9, 
   3.632055177849278*^9}, {3.632055451480164*^9, 3.632055517600219*^9}, {
   3.632055616163237*^9, 3.632055618257159*^9}, {3.6320557064324903`*^9, 
   3.632055721461688*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paths", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"path", "[", 
     RowBox[{"#", ",", "n"}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"Fibonacci", "[", "n", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.632049607276568*^9, 3.632049630389175*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"tree", "[", "7", "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "False"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.632049297283428*^9, 3.63204929744164*^9}, {
  3.632049360308915*^9, 3.632049372484646*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 0.42857142857142855`}, {2., 0.42857142857142855`}, {3., 
      0.14285714285714285`}, {4., 0.42857142857142855`}, {5., 
      0.42857142857142855`}, {6., 0.14285714285714285`}, {7., 0.}, {8., 
      0.14285714285714285`}, {9., 0.42857142857142855`}, {10., 
      0.42857142857142855`}, {11., 0.14285714285714285`}, {12., 
      0.42857142857142855`}, {13., 0.42857142857142855`}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0, 13.}, {0, 0.42857142857142855`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.632049297740069*^9, 3.632049325836025*^9}, {
   3.632049360724947*^9, 3.632049372828106*^9}, 3.6354952898718863`*^9, 
   3.6367162329633923`*^9, 3.637655514205216*^9, 3.6385961663440237`*^9, 
   3.6386805216221533`*^9, 3.638781175783618*^9, 3.6467292638237267`*^9, 
   3.649498911451948*^9, 3.649670096403277*^9, 3.650533409629578*^9, 
   3.650718391633026*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Wavefunctions: computations", "Subsection",
 CellChangeTimes->{{3.650533419401181*^9, 3.6505334255798063`*^9}}],

Cell[TextData[{
 "For a given \[Rho], q>0 and system size n, compute the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["D", "x"], "(", "x", ")"}], TraditionalForm]]],
 " dimensions, ie the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["D", "x"], "(", "i", ")"}], TraditionalForm]]],
 " dimensions averaged on all sites having the same x."
}], "Text",
 CellChangeTimes->{{3.6320422000484324`*^9, 3.632042246912817*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{"avDx", "[", 
   RowBox[{"q_", ",", "vec_", ",", "val_", ",", "xvalues_", ",", "listPos_"}],
    "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"DxList", ",", "xlist", ",", "avDx"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"list", " ", "fractal", " ", "dimensions"}], ",", " ", 
      RowBox[{"indexed", " ", "by", " ", "site"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DxList", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"WfD", "[", 
         RowBox[{"#", ",", "q"}], "]"}], "&"}], "/@", "vec"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "for", " ", "each", " ", "value", " ", "of", " ", "x", " ", "compute", 
        " ", "the", " ", "average"}], " ", "-", " ", 
       RowBox[{
       "on", " ", "positions", " ", "corresponding", " ", "to", " ", "this", 
        " ", "x"}], " ", "-", " ", 
       RowBox[{"fractal", " ", "dimension"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"avDx", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Mean", "[", 
         RowBox[{"DxList", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], "/@", "listPos"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "return", " ", "the", " ", "average", " ", "fractal", " ", "dimension", 
       " ", "as", " ", "a", " ", "function", " ", "of", " ", "x"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"avDx", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"xvalues", ",", "avDx"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "avDx"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.637663366965523*^9, 3.63766336766899*^9}, {
   3.6376636542094803`*^9, 3.6376636546090508`*^9}, {3.63766369696706*^9, 
   3.637663721542987*^9}, {3.637663774545248*^9, 3.637663827187294*^9}, {
   3.637663901777546*^9, 3.637663959294059*^9}, {3.6376641180637712`*^9, 
   3.63766411951794*^9}, {3.637667087009117*^9, 3.6376670892159443`*^9}, 
   3.6505334750409613`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tol", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "14"}]]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"compute", " ", "wavefunctions", " ", "and", " ", "energies"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"val", ",", "vec"}], "}"}], "=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hp", "[", 
      RowBox[{"n", ",", "\[Rho]", ",", "1."}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "order", " ", "wavefunctions", " ", "by", " ", "increasing", " ", 
    "energy"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vec", "=", 
    RowBox[{"vec", "[", 
     RowBox[{"[", 
      RowBox[{"Ordering", "[", "val", "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"drop", " ", "small", " ", "components"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"vec", "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"vec", ",", "tol"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"compute", " ", "x", " ", "for", " ", "each", " ", "site"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xlist", "=", 
    RowBox[{"tree", "[", 
     RowBox[{"n", "+", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"drop", " ", "the", " ", "site", " ", "labels"}], ",", " ", 
    RowBox[{
    "they", " ", "are", " ", "unecessary", " ", "as", " ", "x", " ", "is", 
     " ", "indexed", " ", "by", " ", "increasing", " ", "x", " ", "label"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xlist", "=", 
    RowBox[{"Last", "@", 
     RowBox[{"(", 
      RowBox[{"Transpose", "[", "xlist", "]"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "list", " ", "all", " ", "possible", " ", "values", " ", "of", " ", "x"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xvalues", "=", 
    RowBox[{"Sort", "@", 
     RowBox[{"DeleteDuplicates", "[", "xlist", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "list", " ", "all", " ", "positions", " ", "by", " ", "increasing", " ", 
    "value", " ", "of", " ", "x"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listPos", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"xlist", ",", "#"}], "]"}], "]"}], "&"}], "/@", "xvalues"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6376637410535107`*^9, 3.6376637612913322`*^9}, {
   3.637663903594638*^9, 3.637663904074048*^9}, {3.637664044065216*^9, 
   3.6376640443671303`*^9}, {3.638781296946495*^9, 3.6387812971536083`*^9}, {
   3.638781345298437*^9, 3.63878134803356*^9}, {3.649671679506936*^9, 
   3.649671679809421*^9}, 3.649672746111318*^9, {3.650533554503845*^9, 
   3.6505335545986958`*^9}, {3.650719857989237*^9, 3.650719859419755*^9}, {
   3.650719916441803*^9, 3.6507199166696*^9}, {3.6507199788689747`*^9, 
   3.650719979052927*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qlist", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0.", ",", "10", ",", ".3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avdqlist", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"avDx", "[", 
        RowBox[{"#", ",", "vec", ",", "val", ",", "xvalues", ",", "listPos"}],
         "]"}], "&"}], ",", "qlist"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
   "transpose", " ", "to", " ", "have", " ", "x", " ", "dependance", " ", 
    "as", " ", "the", " ", "first", " ", "direction", " ", "of", " ", "the", 
    " ", "array"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avdqlist", "=", 
   RowBox[{"Transpose", "[", "avdqlist", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6505335876055183`*^9, 3.650533597783469*^9}, {
  3.650534521500149*^9, 3.65053455238519*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"avdqlist", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"AxesStyle", "\[Rule]", "st"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<q\>\"", ",", 
      "\"\<\!\(\*SuperscriptBox[SubscriptBox[\(D\), \(q\)], \
\(\[Psi]\)]\)(x)\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\"\<x=\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"N", "[", "#", "]"}], "]"}]}], "&"}], ")"}], "/@", 
     "xvalues"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.65053360196152*^9, 3.650533653403124*^9}, {
  3.650534106364189*^9, 3.650534107969198*^9}, {3.650534153706285*^9, 
  3.6505341665326433`*^9}, {3.650534256289744*^9, 3.6505343550709*^9}, {
  3.65053451545956*^9, 3.650534517458359*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxVyVsow3EcBfD/1hJzrymxhrWkf5K5zGXYIUnkxTwod5oQhiimhAclQihi
lCQe5gUveNASIpcxI7eSPVAIucQDId/fg1On06cTUKzP1Ak5jpP/9Hf/8qj5
vxxkHwsZYym3ZEekPaund8XXZA98afnBOYOdLMGSKPIFpkuyN9abS7x8/C7I
UvCvM0OBglOyP+xt/JF54ZgsR3uYpaPqy0ZWoK9Aal+bOyQHwmki7yF73koO
Qo5+W+hwe0DmcfM26ClNZw7GliTAkLG5Tw7Bk87en5bPHArT51TSvohZiXpb
apfzooUchtmWiCF5I3M4ajz3xl80zBEwyioFV27Mkagb4I61G3tkFYRZM9yk
gTkKxpT7IoWKORoO5hOXkfddcgyCzrgVoZk5Fu2jMnV3D7MapQKFb2chcxyG
LTZ5uYo5Hue2Ct28O3MClLnaVcHdDlmDzurMss8tZsA1uVacayK3Av6PTcsX
vexPRM2wlU9v2NF8A+IIk9E=
         "]]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxVx1sow2EAxuGvUePCzDFKmMRiMeYwhv/LXEgyoTaHwpgLaRNXi3K4WeOC
cEVKihJLipWEG8mx1BzmNDJCk7QoUk75vgtvvf16RFpDqY5HCIn6+W//9sz9
L8H4ULe/aMRF7YXgwdaN8Ms7aiH0vc4m88oNdSCqCKcxK6+pQzCWbRGNNlxR
h6GnUzff6eGgjkSxUl1283pGHQW7y2jdaj6ljsaTSX1Rl3dCHYMEH5XxvcpO
LYZ8uez4YeqYOg79c8a92GBmCdZrFrZ7xo+oEzCTHFNn4JilkNkWpalPh9RJ
IBPC1dpp5mQMFc68aPXMMjji6+UqBXMKvK2bbouAORViv8/H6rsD6jTsVvL4
xnXmdDi1jZriSWY5VLb9tSIzcwYW2tD3ZWDORMtLQAm/glmB1o250qB85iws
eQ4L7qXM2dDsuAYKIphzMJtYqffyZeZgfWuXEMIMDHSYeAK37c9dgOZSfB54
S01yEVou6/+w27hvWUqUqw==
         "]]}, {
        Hue[0.1421359549995791, 0.6, 0.6], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQDQEf7FFpBgfWvEldq/a+gfI5HKT+/rp++v1LKF/A
IcdHbOns7udQvojDPtk5B8LnPIXyJRxWdb+6xyf3BMqXcegSM1kp9+8RlK/g
cJhBz8dODcZXclhjpHdftvkhlK/ikLjjYi0vG4yv5jDpb/7y6iUPoHwNh+WP
O1O/hsH4Wg7r5nQG20vA+DoOv7dlmvifvA/l6zlset/4RqwYxjdwsMpt3MCm
BeMbOtSlXn8V/PoelG/kIGq83/L1Fhjf2GHX911zrVthfBOHtmPXxYSiYXxT
B6FZQYENpjC+mcOn7WUXTwnD+OYOrWG8DjFf70L5Fg57PzY77rkJ41s6XH2s
eazjAIxv5ZD6JFWycCWMb+2g9YLPwGgKjG/jcHiZxd3JDTC+rYOroMf6tDwY
385B+oGLZ1MsjG/vMHXvA4kjvjC+g8OjtNQgPnsov8HBYfe5e4ruhjB5R4dT
PcasESp37QE0kZmy
         "]]}, {
        Hue[0.37820393249936934`, 0.6, 0.6], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQDQEf7FFpBgdbrro14S/eQPkcDgusD/HcKXwF5Qs4
KEeFLOQofgHliziY3FNilrj3DMqXcBC0KZ3uu/QplC/jUGZW8oB/+xMoX8Gh
5HTXoo2MML6Sw6HKE1mRZY+hfBWHuJaIOVs4YXw1h8vtC062bX4E5Ws4hHzz
WPs+F8bXckhf22d3yATG13H4ICeoycwK4+s58H+3ku258xDKN3AIbN1deHon
jG/okPhO4O302TC+kYN8wIJ8oUYY39hB6M0vromZML6Jw3HOyOoJITC+qYOS
/41vKx1hfDOHt308n7sNYHxzh0Y9oa9fFGB8C4cFLYpn1wvB+JYOyk6rL05g
hfGtHILt+C4U/3wA5Vs7JC06XW/1Dsa3cXBv7gk5/RjGt3Vo47swVeAWjG/n
ILg3ZNX3CzC+vUOMQkhXwQkY38HBaJquf+4BKL/BwaFxxcybD3fA5B0dBHPc
Ow9vfGAPAI+cl2g=
         "]]}, {
        Hue[0.6142719099991583, 0.6, 0.6], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.528488, 0.470624, 0.701351], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQDQEf7FFpBofjE+7lTNryFsrncJh7Y/7fA8xvoHwB
B6EblVUem19B+SIO35NSLIVWv4TyJRwmBLKuKLvzAsqXcVBb9OK9nTWMr+CQ
7LPk+Ok9z6F8JYfnHLYPiyJgfBWHws2iHn3sML6ag5mU8BSTo8+gfA2HirIG
sau9ML6Ww0TfS8J34mB8HYd/rxmmZ5nB+HoON1dJL1AUhvENHDo3sxz78/kp
lG/oUFk1T8XiBoxv5PCt8ZOV3X4Y39ihP+628+wVML6Jw7oH7oFfJsP4pg4Z
JZ/+MDTC+GYOzgsYH7Xlw/jmDq+W7wgJi4fxLRy4rsz76R4A41s6WDo5/rZy
gvGtHCyt92wUNoXxrR2q1E/N2aUB49s4JAuHzZKWhfFtHc5/fOWpKgTj2zmY
nT4w8QQ7jG/voKljZ/vj7xMo38HhV/HHdSu+QPkNDg7VzJMXnn8Nk3d0eBi7
/0vy4yf2AOiUnbA=
         "]]}, {
        Hue[0.8503398874989481, 0.6, 0.6], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[1.6]], 
        LineBox[CompressedData["
1:eJxVyUsoA3AcB/ARy3OJxRKNeTQS89jYg31FSQ3RFAdi2E0mNa2IaMWFA7LW
VpwoRrKDCw4sRXlf1JBiGDYOWjl45f87+Na3b5++qbqehq5gDocj+unv/uVV
/X85sMk12tPrF+YwHFVNpJ2Ynplj0HqzoR8femLmwxmnRduel1kA/cWjtl5B
TsLx0Jnmcv+ROQXRB4GtKQNZBH+60HSbQU7HoGNp8dPzwJwJt1WYIVkjizG6
zT8wj5CzkeWrGZhsJudgLtYcJJeSc3Gy8n64yidLEDBGRNYH7pnzIb1eDrW7
yQWQGZObcnfJhRDyJOZ1B7kINfM7jV4LWQpBSH+3zUyWoVMzvWnrIxdjqzbK
4tKRS/CmSCwONJDl2Mu+t8ZXkhWo4FYvRMnISkx1HPa6xGQVTIYJZ14SuRS8
YGWLKoZcBpkvueAqhKyGqE41Fv7hYQYEq19cp595GGifsRvP7+gvh0uVMKtz
e9TfWw2XBw==
         "]]}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0., 34.}, {0, 1.}}, DisplayFunction -> Identity, 
     AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {
       FormBox["\"q\"", TraditionalForm], 
       FormBox[
       "\"\\!\\(\\*SuperscriptBox[SubscriptBox[\\(D\\), \\(q\\)], \
\\(\[Psi]\\)]\\)(x)\"", TraditionalForm]}, AxesOrigin -> {0, 0}, AxesStyle -> 
     Directive[Large, FontFamily -> "Linux Libertine Display"], 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{0., 34.}, {0, 1.}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{
      "\"x=0.\"", "\"x=0.0625\"", "\"x=0.1875\"", "\"x=0.25\"", "\"x=0.375\"",
        "\"x=0.4375\""}, "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.16500000000000004`], 
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #6}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.37345400000000006`, 0.461046, 0.12992333333333334`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.560181, 0.691569, 0.194885]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.560181, 0.691569, 0.194885]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.560181, 0.691569, 0.194885], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.922526, 0.385626, 0.209179], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.6150173333333333, 0.25708400000000003`, 
                    0.13945266666666667`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.922526, 0.385626, 0.209179]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.922526, 0.385626, 0.209179]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.922526, 0.385626, 0.209179], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.528488, 0.470624, 0.701351], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.3523253333333333, 0.3137493333333333, 
                    0.46756733333333333`], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.528488, 0.470624, 0.701351]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.528488, 0.470624, 0.701351]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.528488, 0.470624, 0.701351], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.772079, 0.431554, 0.102387], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.5147193333333333, 0.28770266666666666`, 
                    0.06825800000000001], FrameTicks -> None, 
                    PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.772079, 0.431554, 0.102387]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.772079, 0.431554, 0.102387]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.772079, 0.431554, 0.102387], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5, ",", #6}], "}"}], 
           ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "True", ",", "True", ",", "True", 
                 ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.650533608555561*^9, {3.650533640476817*^9, 3.650533653770853*^9}, {
   3.650534154224224*^9, 3.6505341669934893`*^9}, 3.65053427594904*^9, {
   3.6505343270136642`*^9, 3.650534355674901*^9}, 3.650534561037369*^9, 
   3.650718399567677*^9, 3.650719870174494*^9, 3.6507199256144648`*^9, 
   3.650719987781773*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison with the theory", "Subsubsection",
 CellChangeTimes->{{3.650534590771367*^9, 3.650534595795209*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   RowBox[{"N", "[", 
    FractionBox[
     RowBox[{
      SqrtBox["5"], "-", "1"}], "2"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lb", "[", "\[Rho]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Rho]", "^", "2"}]}], ")"}], "^", "4"}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"\[Rho]", "^", "4"}]}]}], "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"\[Rho]", "^", "2"}]}], ")"}], "^", "2"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"\[Rho]", "^", "4"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]", "[", 
    RowBox[{"\[Rho]_", ",", "q_"}], "]"}], ":=", 
   FractionBox["1", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[Rho]", "q"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{"\[Rho]_", ",", "q_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"\[Gamma]", "[", 
       RowBox[{"\[Rho]", ",", "q"}], "]"}], 
      SuperscriptBox["\[Rho]", "2"]}], "-", 
     SqrtBox[
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Gamma]", "[", 
           RowBox[{"\[Rho]", ",", "q"}], "]"}], 
          SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]}]]}], 
    RowBox[{"2", 
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"\[Rho]", ",", "q"}], "]"}], 
     SuperscriptBox["\[Rho]", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wfdth", "[", 
    RowBox[{"\[Rho]_", ",", "q_", ",", "x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"q", "<", "4"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"lambda", "[", 
              RowBox[{"\[Rho]", ",", "q"}], "]"}], "q"], 
            RowBox[{"lambda", "[", 
             RowBox[{
              SuperscriptBox["\[Rho]", "q"], ",", "q"}], "]"}]], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"1", "-", 
            RowBox[{"2", "x"}]}], "3"], " ", 
          RowBox[{"Log", "[", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"lb", "[", "\[Rho]", "]"}], "q"], 
            RowBox[{"lb", "[", 
             SuperscriptBox["\[Rho]", "q"], "]"}]], "]"}]}]}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"q", "-", "1"}], ")"}], 
        RowBox[{"Log", "[", 
         SuperscriptBox[
          RowBox[{"Fibonacci", "[", "n", "]"}], 
          RowBox[{"1", "/", "n"}]], "]"}]}], ")"}]}], ",", 
     RowBox[{"d2th", "[", 
      RowBox[{"\[Rho]", ",", "q", ",", "x", ",", "n"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2th", "[", 
    RowBox[{"\[Rho]_", ",", "q_", ",", "x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", " ", 
        RowBox[{"Log", "[", 
         SuperscriptBox[
          RowBox[{"lambda", "[", 
           RowBox[{"\[Rho]", ",", "q"}], "]"}], "q"], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"2", "x"}]}], "3"], " ", 
        RowBox[{"Log", "[", 
         SuperscriptBox[
          RowBox[{"lb", "[", "\[Rho]", "]"}], "q"], "]"}]}]}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "-", "1"}], ")"}], 
      RowBox[{"Log", "[", 
       SuperscriptBox[
        RowBox[{"Fibonacci", "[", "n", "]"}], 
        RowBox[{"1", "/", "n"}]], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dth", "[", 
    RowBox[{"\[Rho]_", ",", "q_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"lambda", "[", 
            RowBox[{"\[Rho]", ",", "q"}], "]"}], "]"}]}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"lambda", "[", 
           RowBox[{
            SuperscriptBox["\[Rho]", "q"], ",", "q"}], "]"}], "]"}]}], 
        ")"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"2", "x"}]}], "3"], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"q", " ", 
          RowBox[{"Log", "[", 
           RowBox[{"lb", "[", "\[Rho]", "]"}], "]"}]}], "-", 
         RowBox[{"Log", "[", 
          RowBox[{"lb", "[", 
           SuperscriptBox["\[Rho]", "q"], "]"}], "]"}]}], ")"}]}]}], ")"}], 
    "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "-", "1"}], ")"}], 
      RowBox[{"Log", "[", "\[Omega]", "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6505346020190897`*^9, 3.650534613880329*^9}, {
   3.650534669150167*^9, 3.650534719479341*^9}, {3.650534984787594*^9, 
   3.650535041805626*^9}, 3.650535089685038*^9, {3.6505352561288023`*^9, 
   3.6505352691138477`*^9}, {3.650535305848927*^9, 3.65053531675263*^9}, {
   3.650539324562834*^9, 3.650539446523595*^9}, {3.650718381841858*^9, 
   3.650718385947525*^9}, {3.650718606206324*^9, 3.650718692550974*^9}, {
   3.650719168987698*^9, 3.650719192466907*^9}, {3.650719240808002*^9, 
   3.6507192732162743`*^9}, {3.650719345419446*^9, 3.6507193562160177`*^9}, {
   3.650719511550655*^9, 3.6507195348102083`*^9}, {3.650719673709799*^9, 
   3.650719673984948*^9}, {3.6507197683523827`*^9, 3.650719828280758*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"wfdth", "[", 
     RowBox[{"\[Rho]", ",", "q", ",", "0", ",", "300"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Point", "@", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"qlist", ",", 
         RowBox[{"avdqlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.650718407766705*^9, 3.650718445165225*^9}, {
  3.650718786586598*^9, 3.6507188588705807`*^9}, {3.650718890554184*^9, 
  3.650718904495407*^9}, {3.650718962406781*^9, 3.650718979744109*^9}, {
  3.650719196348092*^9, 3.650719227265265*^9}, {3.650719261592016*^9, 
  3.6507192917470207`*^9}, {3.65071946572711*^9, 3.6507194913981953`*^9}, {
  3.6507195538237143`*^9, 3.650719633360579*^9}, {3.6507198201683397`*^9, 
  3.6507198235686703`*^9}, {3.650719903243977*^9, 3.6507199098558598`*^9}, {
  3.650719942830716*^9, 3.650719961759276*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1:eJwV0Xk41GsbB3BLIwkzOEwk2+jthERKhdx3CUlJSipTDSEUslTEsZSKspxS
OS0oS1Khc1KvJbKeTBjjhxlkCVkjM4ZIlnfeP57ruT7X93s/9x+Ppqufg7uY
iIhImvD8/04Jd5UwdLtlXpmh/XpaiQepx8dMnDS8AGa6yjgUHrTvvxmgoREC
rn01VwuleHDJ+pgsSSMWBsQf+szPT4BVNdJn1B/A7EHs1a6fgNwrm6/y1HOg
SOm78wfvCeh1yVMaVy+Cz9vqSjblfIfQg2cZ39SZ4D+yr+Oz7jis+PmIeU6/
A7ao8J9dVRgF/8qIuLGAfhhXax7R8RoC/cykpoK8Ecg4wDBZogzAgJ2nas82
HkysZkrwO/vgt3/PaYdb8uBIzwD5TGsf7Nrhr7fGgQcxMgfU+hr64InuZTPn
szyQpb6xHirrA7pkHJ2bwoNhw+UFG572AVGR/7hRjA97f/ZRX3j0QdnmGdXy
ej6sKQnjH53uhWSV62ueMgSwh0odNNXshR/9rGw7XwHY5d/PdVHphcO51E3z
oQLIWGU6HKfQC/KYY+WULICrX01fCUi9EOde7yfDEoARoUwT+/YFIl/LV4aY
TkFpSfwJjXdfwNMqzcNBaRoCVbve77f/AtsDCvPF63/A2lSLgfB1PcBeMj3p
3/4D7kotmceq9oBH/AfpnsEfUMB4kPJYrgfuPP/Xq1h0BkpCVOy7f3XDaHcL
zX/rDNjcrmurZ3fDY1t+cnf6DExdmxy2D+uGRW2dyKKQWfB9dIRR294FVdxH
9n7r5kCq7JE2JbcT7ro6Tk0bzcEhL8+4ysxO8BiX/SsM5yDhlYxP6ONOkBK/
0hN7bA66g7uiReI6wV7f0zfz1hxUS3GvOJ3thO7ozXHtE3Og8OUmY7NuJ8wZ
Nny0KPwFPafO29/I/wyGcYvmq2wWQGRv4dB1Zgds8pp3yz2yAGu/n1VRq+yA
zVZzN3e5LYBy9ZPokuIOMBb5wTkXsQBmDKURyVcdYBY07lvxdgGCfWscxxM6
YA+9M9VbaxHsPV8OcR07gKFXvPj+1yIcjji+Qna4HawHTXoMnESw5Z37oU7V
dvBobhm7cUIE5xeJ3h3Udogu953rPi2CD/sCSzPk2qHiYbpi/HkRbD5iuz9M
oh1MD0jtG4kV9qHFg8Frg42F7YVP34ugcchBa351G1BvBt+R1xLFurQdt1T9
22BowzvLqTFRXOn4XKe9hQtaf/i46wpE0X+l7lsbNhfo9drXXH+K4i0P2u3S
Oi6wvZOq2SQx1NlH2pRfyYXi7PMWuWpiuNtWorboNRfiNHV3etiL4d/Bn9le
8VwwVHxi1vZGDMMPjRtp2XAhdD7W6P1lcexVNeh1ZXKAFXT67uUocTwrGzIK
NRzQGDeb3hYjjnFdFcoaFRyo7pp49/aeOP4dltE9UsgB6Q+OJvmvxZE/EPo6
/TkHUqM0d6YPiqN1ZeDUsxgOVEgU2cU4LMOqtI8Jg3s5sFxu2OuwDgnnaNQD
+dxW+HGDbplmQEIfy2Gr0JZWGFxka4wak/DUB4lzNk2t8O9YETfCgoRt+VXG
Y59a4XrtLcuXdBKeyah7aFvWChKRGzXFEkl4sVpi+fksoScutuULSJiUfYJq
caEVSA0k65WlElhGZ8QVqLTCL1buuTv+kmizsND60acFBpzylNXUpLAl1Cma
0t0MO2N8fWpzV2Iwk5835N0M9xYLV1icksELPWqG3EUCpNfV+N5zl0HJM80s
xgIB0QeamofOyqBHhtnmb78ICHgykhIXLIPeRP8hsZ8E2O1S2cS5LYOaL95x
tgsIkLgeetyrWgY7so/4NAwRECxj/jJxvSzqS1bKXm0iwFm1al+nQBalNiSu
XZlNwKgPf/LtnCwOjKpSsrOE/Q/qDxJFybiiMbrMIpOA+65hA7vIZDS5/M4t
4ikBxPMt4Tk6ZJS6z61ZekTA3i3P8y+6kJGpmO+sfZsAE7t4eblGMhpHd/Fm
QwlgppUUjraS8WtxE7y6TMBR/sjJ6k5hHsBHRggBg7tWkVL7yRjzokzwWzAB
F+5avbw0SsYUhyynTxcJWDYYdPAgn4xPIs3ORV4g4M7WjBmdWTKSq4YNtgYR
oBnblLJsiYxBNTuyvgcI3x9f0pwQo+Bkra7LI+G8hhJ12lmCgtq7zq+0Fc4P
mevX1q6g4L166oVfgQRc/JPum06hoO6qZdEn/Qm4a1RU7KhGQbfvWeEbzhFA
p7PjKzUp+Iexg3y/NwG0a0OMjWspeE2fznjgRcA/HMXlK/QoeKpXYb3kGQLY
IQGH3m+n4O1acfp3F+F/luuOaTlSsK0qp6LTiQD3LenTx/Tk8ImiVf8lWQIu
hQc7aEzLYan75mOzTU1wbTSpmcWSx4wb2iapyU2wT4f8XPqhAqbWlA5+8WiC
+Fzj8n0uvyHz2eTbPNMm+HQoYz5ouyIWmNi7mMk1QXmDX5yeuBL6vIgYNh5n
wz/eUVjfpYQbNtrR7zDZoGYL23wLqPj0VWbNvRw2WCzRr6aFrcKUxD4j1QQ2
uHE+TBY6KqNHhJxHcgAbzKOuvHXRUMEdE42RrONsuOPHL5EeUsE11GxlJUs2
9EVmDaaVrcY/djrnqm9kwzf3IrfKG6qo89+cmYXVbOD5yC9vcFmD/nWSismS
bMizqZv32KCGp9U3Dm6faIRBTwNj8Wk1FLVR4Pc2NoLKy46kGw3q6NA9tLUn
vxGuMgLSG2w1sPJ4u2dBUiPMzCvH2xZpoA3zXkXfxUb4vST5wSdtTXyqV/pT
j94IW07XHJCL1USD609fJ+5uhPLHiqvqpzVxj+kx6m49Yb9c8aadsxZKR8pI
FSk1wn7S2BqiTAsFomf5yWKNwPv8tYqpQ8PDalRZ5jgL/B7HK8Qm0jDtNn+9
5WcW1ItqT+y9TUNn0vtTUx0s0DlT/Ek6iYYSoXlZGUJ/NRyK+vM+DU/JzLqI
CX30I/KSU2gYn37/UXkbC3ZNCuqfvaQhNZIlixwWKO05fr36Iw0T9Kaa9zax
IDCX53KdScN1i5GkeTYL2PI3duypE+YhqVa5Qt/qejNVx6Lh0aXgGbLQIoEy
p5tbafhXtq4Ch8WC0ZRy6Oun4bxzjL57PQusxZ1WZw7Q8Fry3BGq0Jme4z/c
h2i4/W5BArOOBaeMVPJGRmkY0Tquqy90S22gKp9PQ+3ZGdVZJgsM9aVm/xHQ
0P9vnQ8vhE5IetIcNE1DI9eo8yeEtjnZcHN2VpgPxohU1bLgWdVpj+I5GgZ0
GvRcEHrZ+rmdYfM0nJT9Vv+70C4Jf64xXxTuU3jD/PyRBWWC//xcWqKhX1R0
a4LQ/wPSQdoG
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.2},
  DisplayFunction->Identity,
  Epilog->PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAmIQjQo+2BuDwWV7uZ9bfOe6vYbyH9t7fbZefo7ruf0Z
MHhj/y9Ya8qmqsdQ+c/2u1hMvziseWAPMeeH/bHqZFEp+btQ9X/stb6umK7G
eMv+LJjP4PC4UevawS3XofqZHZqMLrTl/rtqPxMMWB0mxMs8PrrpCtQ8DgfO
hbHvIzZftk8DAy6H6PwzTGyvL0HN53F48W2KoIz3Jah5/A6nRBSrfE9ehNon
4PAx9fEkr7iLUPOEHNb8Xep0keUiVL2wQ8lVj27unReg5os4rK0zma5UcQHq
HlGHAsHz877YX4CaJ+YwRy6H8RHfBah5Eg5FkxmuBx8/DzVP0oEpZAXD4qrz
UPOkHOa4vU1UMTsPNU/age3gTZ5ZP85B3S/joHGbYT/TwXNQ8+QcmmbLWff0
nYOaJ++Qxqgi3ZkA4ys4zLhwVSnT7BzUPQoOd65mpW7mPwe1T9HBMCb4MOOb
s1DzlBw684Iy/p46C7VfyYHXpZArZs1ZqHnKDgofKnff7T8LNU/ZoWDGZS3v
0rP2AG+o4xA=
    "]],
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6507184233671417`*^9, 3.650718445789122*^9}, {
   3.650718786971148*^9, 3.650718859699255*^9}, 3.650718905199617*^9, 
   3.6507189808930397`*^9, {3.65071921374327*^9, 3.650719227792285*^9}, {
   3.650719263444695*^9, 3.650719292323936*^9}, 3.650719358707658*^9, {
   3.650719467373415*^9, 3.65071949196379*^9}, {3.650719538196452*^9, 
   3.650719554428334*^9}, {3.650719587991088*^9, 3.6507196342943983`*^9}, {
   3.6507197721981297`*^9, 3.6507198306925917`*^9}, {3.650719883900537*^9, 
   3.650719990815322*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[Rho]", "]"}]], "Input",
 CellChangeTimes->{{3.650723516345461*^9, 3.6507235185382767`*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["D", "1"], " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"\[Rho]", " ", "Log", " ", "\[Rho]", " ", 
       FractionBox["d", 
        RowBox[{"d", " ", "\[Rho]"}]]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", " ", "Log", " ", "\[Lambda]"}], " ", "+", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"2", "x"}]}], "3"], "Log", " ", "lb"}]}], " ", ")"}]}]}], 
  TraditionalForm]],
 FormatType->"TraditionalForm"]], "Text",
 CellChangeTimes->{{3.650723946127346*^9, 3.650723978597384*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "=", "10"}], ",", 
     RowBox[{"\[Rho]", "=", "12."}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", " ", 
       RowBox[{"Log", "[", 
        RowBox[{"lambda", "[", 
         RowBox[{"\[Rho]", ",", "1"}], "]"}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"2", "x"}]}], "3"], 
       RowBox[{"Log", "[", 
        RowBox[{"lb", "[", "\[Rho]", "]"}], "]"}]}], "-", 
      RowBox[{"x", " ", "\[Rho]", " ", 
       RowBox[{"Log", "[", "\[Rho]", "]"}], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0"}], "]"}], "[", "lambda", "]"}], "[", 
         RowBox[{"\[Rho]", ",", "1"}], "]"}], 
        RowBox[{"lambda", "[", 
         RowBox[{"\[Rho]", ",", "1"}], "]"}]]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"2", "x"}]}], "3"], "\[Rho]", " ", 
       RowBox[{"Log", "[", "\[Rho]", "]"}], 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", "1", "]"}], "[", "lb", "]"}], "[", 
         "\[Rho]", "]"}], 
        RowBox[{"lb", "[", "\[Rho]", "]"}]]}]}], ",", 
     RowBox[{
      RowBox[{"Log", "[", "\[Omega]", "]"}], 
      RowBox[{"dth", "[", 
       RowBox[{"\[Rho]", ",", "0.999999", ",", "x"}], "]"}]}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.650723265764867*^9, 3.6507233483368*^9}, {
  3.650723506298774*^9, 3.650723711730349*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.412742510087561`"}], ",", 
   RowBox[{"-", "5.412732824461093`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.650723348858259*^9, {3.650723562637055*^9, 3.650723583983691*^9}, {
   3.6507236183174467`*^9, 3.650723712151079*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Derivative", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "[", "lambda", "]"}], "[", 
   RowBox[{"r", ",", "1"}], "]"}], "\[Equal]", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"lambda", "[", 
     RowBox[{"r", ",", "1"}], "]"}], ",", "r"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.650723373172077*^9, 3.650723387495203*^9}, {
  3.6507234692277184`*^9, 3.650723497187093*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6507233600032053`*^9, 3.650723384340971*^9}, {
  3.650723477187603*^9, 3.650723497744404*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1021},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 92, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[697, 27, 299, 5, 32, "Input"],
Cell[999, 34, 950, 14, 32, "Output"]
}, Open  ]],
Cell[1964, 51, 223, 5, 55, "Input"],
Cell[2190, 58, 654, 18, 77, "Input"],
Cell[2847, 78, 351, 8, 55, "Input"],
Cell[CellGroupData[{
Cell[3223, 90, 200, 5, 32, "Input"],
Cell[3426, 97, 674, 14, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4149, 117, 146, 2, 71, "Section"],
Cell[CellGroupData[{
Cell[4320, 123, 150, 2, 49, "Subsection"],
Cell[4473, 127, 2524, 66, 1401, "Input"],
Cell[7000, 195, 2808, 74, 1585, "Input"],
Cell[9811, 271, 3023, 79, 1603, "Input"],
Cell[12837, 352, 2900, 82, 2362, "Input"],
Cell[15740, 436, 1930, 52, 1401, "Input"],
Cell[17673, 490, 3327, 88, 2141, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21049, 584, 100, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[21174, 589, 165, 2, 49, "Subsection"],
Cell[21342, 593, 255, 5, 51, "Text"],
Cell[21600, 600, 1377, 41, 117, "Text"],
Cell[22980, 643, 1378, 35, 116, "Input"],
Cell[24361, 680, 1135, 34, 55, "Input"],
Cell[25499, 716, 1826, 55, 146, "Text"],
Cell[27328, 773, 2339, 61, 297, "Input"],
Cell[CellGroupData[{
Cell[29692, 838, 158, 2, 40, "Subsubsection"],
Cell[29853, 842, 933, 21, 325487, "Text"],
Cell[30789, 865, 6141, 148, 847168, "Input"],
Cell[36933, 1015, 322, 9, 68588, "Input"],
Cell[CellGroupData[{
Cell[37280, 1028, 269, 6, 65502, "Input"],
Cell[37552, 1036, 1582, 35, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39195, 1078, 117, 1, 41, "Subsection"],
Cell[39315, 1081, 487, 14, 51, "Text"],
Cell[39805, 1097, 2394, 61, 231, "Input"],
Cell[42202, 1160, 3397, 93, 429, "Input"],
Cell[45602, 1255, 922, 25, 99, "Input"],
Cell[CellGroupData[{
Cell[46549, 1284, 879, 22, 38, "Input"],
Cell[47431, 1308, 29777, 604, 273, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77245, 1917, 117, 1, 40, "Subsubsection"],
Cell[77365, 1920, 5840, 173, 412, "Input"],
Cell[CellGroupData[{
Cell[83230, 2097, 1222, 28, 32, "Input"],
Cell[84455, 2127, 5403, 102, 239, "Output"]
}, Open  ]],
Cell[89873, 2232, 131, 2, 32, "Input"],
Cell[90007, 2236, 685, 20, 66, "Text"],
Cell[CellGroupData[{
Cell[90717, 2260, 1614, 47, 104, "Input"],
Cell[92334, 2309, 288, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92659, 2321, 437, 12, 32, "Input"],
Cell[93099, 2335, 148, 2, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
