(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     76226,       2364]
NotebookOptionsPosition[     72926,       2250]
NotebookOutlinePosition[     73283,       2266]
CellTagsIndexPosition[     73240,       2263]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Calculs Zhong", "Subsection",
 CellChangeTimes->{{3.627194695607769*^9, 3.627194702326935*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Atomic chain: weak coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"]}], "=", 
    RowBox[{
     SubscriptBox["t", "w"], "'"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.627195743053899*^9, 3.627195793682662*^9}, {
  3.627197719312595*^9, 3.627197724063958*^9}, {3.6272058016133947`*^9, 
  3.62720580386905*^9}}],

Cell[TextData[{
 "We only consider the chain ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "w"], 
    SubscriptBox["t", "s"], 
    SubscriptBox["t", "w"], 
    SubscriptBox["t", "s"], 
    SubscriptBox["t", "w"]}], TraditionalForm]]],
 ", this is sufficient to get the correct jump amplitudes (off-diagonal \
elements of the effective Hamiltonian)\nHowever to get the correct on-site \
energies, we also need to know what\[CloseCurlyQuote]s on the left and on the \
right of this chain."
}], "Text",
 CellChangeTimes->{{3.62720580791742*^9, 3.6272058839816523`*^9}},
 Background->GrayLevel[0.85]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hmm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "ts", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ts", ",", "0", ",", "tw", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "tw", ",", "0", ",", "ts"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "ts", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ham", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tw", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "tw"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hma", "=", 
   RowBox[{"Transpose", "@", "Ham"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.627194712227405*^9, 3.6271947929264183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ham", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"e", " ", 
       RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "Hmm"}], "]"}], ".", 
    "Hma"}], "//", "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6271948195202007`*^9, 3.6271948900612307`*^9}, {
   3.627205607712082*^9, 3.62720560809573*^9}, 3.6272057608350677`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"e", " ", 
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "2"], "-", 
          SuperscriptBox["ts", "2"], "-", 
          SuperscriptBox["tw", "2"]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["ts", "2"], " ", 
        SuperscriptBox["tw", "3"]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]]},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["ts", "2"], " ", 
        SuperscriptBox["tw", "3"]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"e", " ", 
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "2"], "-", 
          SuperscriptBox["ts", "2"], "-", 
          SuperscriptBox["tw", "2"]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.627194834219123*^9, 3.627194890387882*^9}, 
   3.627205608684431*^9, 3.627205763429648*^9, 3.627212386037405*^9, 
   3.627216217426023*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"we", " ", "indeed", " ", "recover", " ", "Niu", " ", "and", " ", 
   RowBox[{"Nori", "'"}], "s", " ", "result", " ", "in", " ", "the", " ", 
   "perturbative", " ", "limit", " ", 
   SubscriptBox["t", "w"], 
   RowBox[{"<<", 
    SubscriptBox["t", "s"]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.627195815745716*^9, 3.627195842113544*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Ham", ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{
       RowBox[{"e", " ", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "Hmm"}], "]"}], ".",
      "Hma"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
  RowBox[{"e", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.627195844641129*^9, 3.627195868995543*^9}, {
   3.6272056105938387`*^9, 3.6272056109606237`*^9}, 3.627205766882978*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["tw", "3"], 
  SuperscriptBox["ts", "2"]]], "Output",
 CellChangeTimes->{{3.627195851867525*^9, 3.627195869421377*^9}, 
   3.627205611366452*^9, 3.627205767399468*^9, 3.627216219490499*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "exact", " ", "result", " ", "for", " ", "the", " ", "weak", " ", 
    "renormalized", " ", "coupling"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ham", ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"e", " ", 
           RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "Hmm"}], "]"}], 
        ".", "Hma"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "\[Rule]", 
        RowBox[{"ts", " ", "xs"}]}], ",", 
       RowBox[{"tw", "\[Rule]", 
        RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"%", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["xs", "2"], "\[Rule]", 
         RowBox[{"S", "+", "1"}]}], ",", 
        RowBox[{
         SuperscriptBox["xs", "4"], "\[Rule]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"S", "+", "1"}], ")"}], "2"]}]}], "}"}]}], "//", 
     "Expand"}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.627212396478675*^9, 3.627212427940279*^9}, {
   3.627212535468639*^9, 3.627212535994192*^9}, 3.6272162145974216`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"ts", " ", 
   SuperscriptBox["\[Rho]", "3"]}], 
  RowBox[{
   SuperscriptBox["S", "2"], "-", 
   SuperscriptBox["\[Rho]", "2"], "-", 
   RowBox[{"S", " ", 
    SuperscriptBox["\[Rho]", "2"]}]}]]], "Output",
 CellChangeTimes->{{3.627212388280253*^9, 3.627212428369458*^9}, 
   3.627216220425268*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Atomic chain: strong coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"]}], "=", 
    RowBox[{
     SubscriptBox["t", "s"], "'"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.627195743053899*^9, 3.627195793682662*^9}, {
  3.627197705002224*^9, 3.62719773838306*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hmm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "ts"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ts", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ham", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tw", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "tw"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hma", "=", 
   RowBox[{"Transpose", "@", "Ham"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.627194712227405*^9, 3.6271947929264183`*^9}, {
  3.627197758418415*^9, 3.627197791600377*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ham", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"e", " ", 
       RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", "Hmm"}], "]"}], ".", 
    "Hma"}], "//", "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6271948195202007`*^9, 3.6271948900612307`*^9}, {
   3.6272055996954308`*^9, 3.627205600432376*^9}, 3.6272057476351767`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"e", " ", 
        SuperscriptBox["tw", "2"]}], 
       RowBox[{
        SuperscriptBox["e", "2"], "-", 
        SuperscriptBox["ts", "2"]}]], 
      FractionBox[
       RowBox[{"ts", " ", 
        SuperscriptBox["tw", "2"]}], 
       RowBox[{
        SuperscriptBox["e", "2"], "-", 
        SuperscriptBox["ts", "2"]}]]},
     {
      FractionBox[
       RowBox[{"ts", " ", 
        SuperscriptBox["tw", "2"]}], 
       RowBox[{
        SuperscriptBox["e", "2"], "-", 
        SuperscriptBox["ts", "2"]}]], 
      FractionBox[
       RowBox[{"e", " ", 
        SuperscriptBox["tw", "2"]}], 
       RowBox[{
        SuperscriptBox["e", "2"], "-", 
        SuperscriptBox["ts", "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.627194834219123*^9, 3.627194890387882*^9}, 
   3.6271977958027887`*^9, 3.627205601446913*^9, {3.627205728531623*^9, 
   3.627205748386498*^9}, 3.6272122816741333`*^9, 3.627216200456122*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"we", " ", "indeed", " ", "recover", " ", "Niu", " ", "and", " ", 
   RowBox[{"Nori", "'"}], "s", " ", "result", " ", "in", " ", "the", " ", 
   "perturbative", " ", "limit", " ", 
   SubscriptBox["t", "w"], 
   RowBox[{"<<", 
    SubscriptBox["t", "s"]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.627195815745716*^9, 3.627195842113544*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Ham", ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{
       RowBox[{"e", " ", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", "Hmm"}], "]"}], ".",
      "Hma"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
  RowBox[{"e", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.627195844641129*^9, 3.627195868995543*^9}, {
   3.627205603920376*^9, 3.627205604336516*^9}, 3.6272057557949333`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["tw", "2"], "ts"]}]], "Output",
 CellChangeTimes->{{3.627195851867525*^9, 3.627195869421377*^9}, 
   3.627197852908832*^9, 3.627205604809751*^9, {3.627205752782446*^9, 
   3.627205756559331*^9}, 3.6272162031197433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "exact", " ", "result", " ", "for", " ", "the", " ", "strong", " ", 
    "renormalized", " ", "coupling"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Ham", ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{"e", " ", 
           RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "-", "Hmm"}], "]"}], 
        ".", "Hma"}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e", "\[Rule]", 
        RowBox[{"ts", " ", "xs"}]}], ",", 
       RowBox[{"tw", "\[Rule]", 
        RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["xs", "2"], "\[Rule]", 
      RowBox[{"S", "+", "1"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.627212230452759*^9, 3.6272122760916157`*^9}, {
   3.6272123184768248`*^9, 3.62721235852339*^9}, 3.627216195606756*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"ts", " ", 
   SuperscriptBox["\[Rho]", "2"]}], "S"]], "Output",
 CellChangeTimes->{{3.627212277334516*^9, 3.627212286674917*^9}, 
   3.627212320976989*^9, {3.627212352053522*^9, 3.627212359107623*^9}, 
   3.6272162057839203`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Atomic chain: strong-weak coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["t", "s"], "'"}], 
     RowBox[{
      SubscriptBox["t", "w"], "'"}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ") with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"]}], "=", 
    RowBox[{
     SubscriptBox["t", "w"], "'"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"]}], "=", 
    RowBox[{
     SubscriptBox["t", "s"], "'"}]}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.627195743053899*^9, 3.627195793682662*^9}, {
  3.627197719312595*^9, 3.627197724063958*^9}, {3.6272039952495937`*^9, 
  3.627204028099547*^9}, {3.6272187790881433`*^9, 3.627218783511091*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hmm", "=", " ", 
   RowBox[{"Normal", "[", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "ts"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", "ts"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "5"}], "}"}], "\[Rule]", "tw"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}], "\[Rule]", "ts"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hmm", "=", 
   RowBox[{"Hmm", "+", 
    RowBox[{"Transpose", "@", "Hmm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hma", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", "tw"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", "tw"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "tw"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "3"}], "}"}], "\[Rule]", "tw"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ham", "=", 
   RowBox[{"Transpose", "@", "Ham"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.627217404939454*^9, 3.627217573806652*^9}, 
   3.6272176413290787`*^9, 3.627217683055729*^9, {3.6272183539733*^9, 
   3.627218481174696*^9}, {3.62727798581682*^9, 3.627278169370241*^9}}],

Cell[TextData[{
 "The 3 sites obtained after decimation are numbered 2-1-3. Because the new \
couplings are ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "s"], "'"}], 
    RowBox[{
     SubscriptBox["t", "w"], "'"}]}], TraditionalForm]]],
 ", we know that the on-site energy of site 1 is equal to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "s"], TraditionalForm]]],
 "\[CloseCurlyQuote].\nWe also check in passing that the exact RG yields only \
on-site and nearest neighbours terms. It therefore maps a chain to a chain \
(is this a general property?)."
}], "Text",
 CellChangeTimes->{{3.6272207554361*^9, 3.6272209408936253`*^9}, {
  3.62722098423769*^9, 3.627221026750358*^9}, {3.627278279764189*^9, 
  3.6272783128688*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Ham", ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{
      RowBox[{"e", " ", 
       RowBox[{"IdentityMatrix", "[", "6", "]"}]}], "-", "Hmm"}], "]"}], ".", 
    "Hma"}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.627217700811689*^9, 3.627217741965763*^9}, {
  3.627217791583091*^9, 3.627217862591617*^9}, {3.627218506660512*^9, 
  3.627218509826779*^9}, {3.6272781782478848`*^9, 3.6272781830005903`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["tw", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["e", "5"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["e", "3"], " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           RowBox[{"e", " ", 
            SuperscriptBox["ts", "4"]}], "-", 
           RowBox[{
            SuperscriptBox["e", "3"], " ", 
            SuperscriptBox["tw", "2"]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["e", "6"], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["e", "4"], " ", 
          SuperscriptBox["ts", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["e", "2"], " ", 
          SuperscriptBox["ts", "4"]}], "-", 
         SuperscriptBox["ts", "6"], "-", 
         RowBox[{
          SuperscriptBox["e", "4"], " ", 
          SuperscriptBox["tw", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["e", "2"], " ", 
          SuperscriptBox["ts", "2"], " ", 
          SuperscriptBox["tw", "2"]}]}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["tw", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["e", "5"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["e", "3"], " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           RowBox[{"e", " ", 
            SuperscriptBox["ts", "4"]}], "-", 
           RowBox[{
            SuperscriptBox["e", "3"], " ", 
            SuperscriptBox["tw", "2"]}], "+", 
           RowBox[{"e", " ", 
            SuperscriptBox["ts", "2"], " ", 
            SuperscriptBox["tw", "2"]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["e", "6"], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["e", "4"], " ", 
          SuperscriptBox["ts", "2"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["e", "2"], " ", 
          SuperscriptBox["ts", "4"]}], "-", 
         SuperscriptBox["ts", "6"], "-", 
         RowBox[{
          SuperscriptBox["e", "4"], " ", 
          SuperscriptBox["tw", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["e", "2"], " ", 
          SuperscriptBox["ts", "2"], " ", 
          SuperscriptBox["tw", "2"]}]}]]}], 
      FractionBox[
       RowBox[{
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["e", "4"], " ", "ts"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["e", "2"], " ", 
           SuperscriptBox["ts", "3"]}], "+", 
          SuperscriptBox["ts", "5"], "-", 
          RowBox[{
           SuperscriptBox["e", "2"], " ", "ts", " ", 
           SuperscriptBox["tw", "2"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "6"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["ts", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "4"]}], "-", 
        SuperscriptBox["ts", "6"], "-", 
        RowBox[{
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["tw", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "2"], " ", 
         SuperscriptBox["tw", "2"]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["e", "2"], " ", 
           SuperscriptBox["ts", "2"], " ", "tw"}], "-", 
          RowBox[{
           SuperscriptBox["ts", "4"], " ", "tw"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "6"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["ts", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "4"]}], "-", 
        SuperscriptBox["ts", "6"], "-", 
        RowBox[{
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["tw", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "2"], " ", 
         SuperscriptBox["tw", "2"]}]}]]},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["e", "4"], " ", "ts"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["e", "2"], " ", 
           SuperscriptBox["ts", "3"]}], "+", 
          SuperscriptBox["ts", "5"], "-", 
          RowBox[{
           SuperscriptBox["e", "2"], " ", "ts", " ", 
           SuperscriptBox["tw", "2"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "6"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["ts", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "4"]}], "-", 
        SuperscriptBox["ts", "6"], "-", 
        RowBox[{
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["tw", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "2"], " ", 
         SuperscriptBox["tw", "2"]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "5"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["e", "3"], " ", 
           SuperscriptBox["ts", "2"]}], "+", 
          RowBox[{"e", " ", 
           SuperscriptBox["ts", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["e", "3"], " ", 
           SuperscriptBox["tw", "2"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "6"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["ts", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "4"]}], "-", 
        SuperscriptBox["ts", "6"], "-", 
        RowBox[{
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["tw", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "2"], " ", 
         SuperscriptBox["tw", "2"]}]}]], "0"},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["e", "2"], " ", 
           SuperscriptBox["ts", "2"], " ", "tw"}], "-", 
          RowBox[{
           SuperscriptBox["ts", "4"], " ", "tw"}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "6"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["ts", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "4"]}], "-", 
        SuperscriptBox["ts", "6"], "-", 
        RowBox[{
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["tw", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "2"], " ", 
         SuperscriptBox["tw", "2"]}]}]], "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "5"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["e", "3"], " ", 
           SuperscriptBox["ts", "2"]}], "+", 
          RowBox[{"e", " ", 
           SuperscriptBox["ts", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["e", "3"], " ", 
           SuperscriptBox["tw", "2"]}], "+", 
          RowBox[{"e", " ", 
           SuperscriptBox["ts", "2"], " ", 
           SuperscriptBox["tw", "2"]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "6"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["ts", "2"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "4"]}], "-", 
        SuperscriptBox["ts", "6"], "-", 
        RowBox[{
         SuperscriptBox["e", "4"], " ", 
         SuperscriptBox["tw", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         SuperscriptBox["ts", "2"], " ", 
         SuperscriptBox["tw", "2"]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6272185101140633`*^9, {3.627278178874888*^9, 3.62727818336165*^9}}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["V", "s"], "'"}], TraditionalForm]]],
 " using Fr\[EAcute]d\[EAcute]ric\[CloseCurlyQuote]s notations:\n\[Rho] = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", "w"], "/", 
    SubscriptBox["t", "s"]}], TraditionalForm]]],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "s"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"e", "-", 
       SubscriptBox["V", "s"]}], ")"}], "/", 
     SubscriptBox["t", "s"]}]}], TraditionalForm]]],
 " (Because everywhere but at atomic sites the chain only involves ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "s"], TraditionalForm]]],
 " couplings, the non-diagonal part of the renormalized Hamiltonian only \
involves e in terms of the form e - ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "s"], TraditionalForm]]],
 ". Thus we can make the change ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"e", "-", 
     SubscriptBox["V", "s"]}], "\[Rule]", "e"}], TraditionalForm]]],
 " and completely forget about ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "s"], TraditionalForm]]],
 ", which just amounts to translating the energies.)\nS = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["x", "s"], "2"], "-", "1"}], TraditionalForm]]],
 "\t(Note that S is negative in the perturbative limit.)"
}], "Text",
 CellChangeTimes->{{3.6272207554361*^9, 3.6272209408936253`*^9}, {
  3.62722098423769*^9, 3.627221026750358*^9}, {3.627221205071259*^9, 
  3.627221308383658*^9}, {3.6272213477763777`*^9, 3.627221615202067*^9}},
 Background->GrayLevel[0.85]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Ham", ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"e", " ", 
         RowBox[{"IdentityMatrix", "[", "6", "]"}]}], "-", "Hmm"}], "]"}], 
      ".", "Hma"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e", "\[Rule]", 
      RowBox[{"ts", " ", "xs"}]}], ",", 
     RowBox[{"tw", "\[Rule]", 
      RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["xs", "2"], "\[Rule]", 
        RowBox[{"S", "+", "1"}]}], ",", 
       RowBox[{
        SuperscriptBox["xs", "4"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"S", "+", "1"}], ")"}], "2"]}], ",", 
       RowBox[{
        SuperscriptBox["xs", "6"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"S", "+", "1"}], ")"}], "3"]}]}], "}"}]}], "//", "Expand"}],
    "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{
   SuperscriptBox["xs", "2"], "\[Rule]", 
   RowBox[{"S", "+", "1"}]}]}]}], "Input",
 CellChangeTimes->{
  3.627222662381996*^9, {3.62722446574128*^9, 3.6272244657882547`*^9}, {
   3.627277000149316*^9, 3.627277044132064*^9}, 3.627278205627159*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"ts", " ", "xs", " ", 
    SuperscriptBox["\[Rho]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["S", "2"]}], "+", 
      SuperscriptBox["\[Rho]", "2"], "+", 
      RowBox[{"2", " ", "S", " ", 
       SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], 
   RowBox[{"S", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["S", "2"], "-", 
      SuperscriptBox["\[Rho]", "2"], "-", 
      RowBox[{"S", " ", 
       SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.627278206064558*^9}]
}, Open  ]],

Cell[TextData[{
 "Thus ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["V", "s"], "'"}], "=", 
    RowBox[{
     SubscriptBox["V", "w"], "-", 
     FractionBox[
      RowBox[{"ts", " ", "xs", " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["S", "2"]}], "+", 
         SuperscriptBox["\[Rho]", "2"], "+", 
         RowBox[{"2", " ", "S", " ", 
          SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], 
      RowBox[{"S", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["S", "2"], "-", 
         SuperscriptBox["\[Rho]", "2"], "-", 
         RowBox[{"S", " ", 
          SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}]]}]}], 
   TraditionalForm]]],
 ", which can be rewritten\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["x", "s"], "'"}], "=", 
    RowBox[{
     SubscriptBox["x", "w"], "-", 
     RowBox[{"2", 
      SuperscriptBox["\[Rho]", "2"], 
      FractionBox[
       RowBox[{" ", 
        RowBox[{"S", "-", " ", 
         SuperscriptBox["\[Rho]", "2"], "-", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], "/", 
          RowBox[{"(", 
           RowBox[{"2", "S"}], ")"}]}]}]}], 
       RowBox[{
        SuperscriptBox["S", "2"], "-", 
        RowBox[{"S", " ", 
         SuperscriptBox["\[Rho]", "2"]}], "-", 
        SuperscriptBox["\[Rho]", "2"]}]], 
      SubscriptBox["x", "s"]}]}]}], TraditionalForm]]],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "w"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"e", "-", 
       SubscriptBox["V", "w"]}], ")"}], "/", 
     SubscriptBox["t", "s"]}]}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.627221659377637*^9, 3.627221868706966*^9}, {
  3.627277324248191*^9, 3.627277325543396*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Atomic chain: weak-weak coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["t", "w"], "'"}], 
     RowBox[{
      SubscriptBox["t", "w"], "'"}]}]}], TraditionalForm]]],
 ") with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"]}], "=", 
    RowBox[{
     SubscriptBox["t", "w"], "'"}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"]}], "=", 
    RowBox[{
     SubscriptBox["t", "s"], "'"}]}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.627195743053899*^9, 3.627195793682662*^9}, {
  3.627197719312595*^9, 3.627197724063958*^9}, {3.6272039952495937`*^9, 
  3.627204028099547*^9}, {3.627210100055922*^9, 3.627210105454248*^9}, {
  3.6272772120783*^9, 3.6272772144202967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "here", " ", "sites", "  ", "of", " ", "the", " ", "chain", " ", 
      FormBox[
       RowBox[{
        RowBox[{
         SubscriptBox["t", "w"], "'"}], 
        RowBox[{
         SubscriptBox["t", "w"], "'"}]}],
       TraditionalForm]}], "=", 
     RowBox[{
      RowBox[{
       FormBox[
        RowBox[{
         SubscriptBox["t", "w"], 
         SubscriptBox["t", "s"], 
         SubscriptBox["t", "w"], 
         SubscriptBox["t", "s"], 
         SubscriptBox["t", "w"]}],
        TraditionalForm], 
       FormBox[
        RowBox[{
         SubscriptBox["t", "w"], 
         SubscriptBox["t", "s"], 
         SubscriptBox["t", "w"], 
         SubscriptBox["t", "s"], 
         SubscriptBox["t", "w"]}],
        TraditionalForm], " ", "are", " ", "numbered", " ", "2"}], "-", "4", 
      "-", "5", "-", "6", "-", "7", "-", "1", "-", "8", "-", "9", "-", "10", 
      "-", "11", "-", 
      RowBox[{
      "3", " ", "so", " ", "that", " ", "atomic", " ", "sites", " ", "are", 
       " ", "numbered", " ", "2"}]}]}], ",", " ", 
    RowBox[{"1", " ", "and", " ", "3."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hmm", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", "ts"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", "ts"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}], "\[Rule]", "ts"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"7", ",", "8"}], "}"}], "\[Rule]", "ts"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", "tw"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", "7"}], "}"}], "\[Rule]", "tw"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "8"}], "}"}]}], "]"}], "//", "Normal"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hmm", "=", 
     RowBox[{"Hmm", "+", 
      RowBox[{"Transpose", "@", "Hmm"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ham", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", "tw"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "5"}], "}"}], "\[Rule]", "tw"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", "tw"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "8"}], "}"}], "\[Rule]", "tw"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "8"}], "}"}]}], "]"}], "//", "Normal"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hma", "=", 
     RowBox[{"Transpose", "@", "Ham"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.627194712227405*^9, 3.6271947929264183`*^9}, {
   3.627204713820641*^9, 3.62720485587162*^9}, {3.6272049116791553`*^9, 
   3.627204948432585*^9}, {3.6272051657139893`*^9, 3.6272051870548067`*^9}, {
   3.627205229853731*^9, 3.627205299813802*^9}, {3.6272220110056353`*^9, 
   3.6272220143630457`*^9}, 3.627222056999649*^9, {3.627222515380849*^9, 
   3.6272226318244553`*^9}, {3.627222722418284*^9, 3.627222722527643*^9}, {
   3.6272244179044313`*^9, 3.6272244420609083`*^9}, {3.6272768742614193`*^9, 
   3.627276975846401*^9}, {3.627277131074552*^9, 3.6272771841791058`*^9}, {
   3.627277225235944*^9, 3.627277245292617*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "we", " ", "indeed", " ", "recover", " ", "the", " ", "same", " ", 
     "off"}], "-", 
    RowBox[{"diagonal", " ", "elements", " ", "than", " ", "before"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ham", ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{
       RowBox[{"e", " ", 
        RowBox[{"IdentityMatrix", "[", "8", "]"}]}], "-", "Hmm"}], "]"}], ".",
      "Hma"}], "//", "Simplify"}], "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.6271948195202007`*^9, 3.6271948900612307`*^9}, {
   3.62720555240161*^9, 3.627205554190749*^9}, {3.627206092897173*^9, 
   3.627206106308123*^9}, 3.627222643774499*^9, {3.627224448187372*^9, 
   3.627224448250483*^9}, 3.627276913106764*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"2", " ", "e", " ", 
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "2"], "-", 
          SuperscriptBox["ts", "2"], "-", 
          SuperscriptBox["tw", "2"]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["ts", "2"], " ", 
        SuperscriptBox["tw", "3"]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["ts", "2"], " ", 
        SuperscriptBox["tw", "3"]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]]},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["ts", "2"], " ", 
        SuperscriptBox["tw", "3"]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"e", " ", 
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "2"], "-", 
          SuperscriptBox["ts", "2"], "-", 
          SuperscriptBox["tw", "2"]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], "0"},
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["ts", "2"], " ", 
        SuperscriptBox["tw", "3"]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]], "0", 
      FractionBox[
       RowBox[{"e", " ", 
        SuperscriptBox["tw", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["e", "2"], "-", 
          SuperscriptBox["ts", "2"], "-", 
          SuperscriptBox["tw", "2"]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["e", "4"], "+", 
        SuperscriptBox["ts", "4"], "-", 
        RowBox[{
         SuperscriptBox["e", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["ts", "2"]}], "+", 
           SuperscriptBox["tw", "2"]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.627194834219123*^9, 3.627194890387882*^9}, 
   3.627205315351665*^9, 3.6272055549879208`*^9, 3.62721062084265*^9, 
   3.62722201867584*^9, 3.627222059268421*^9, 3.627222644645542*^9, 
   3.62722272492404*^9, 3.627224448871211*^9, 3.627276913687408*^9, 
   3.6272769844825068`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Ham", ".", 
      RowBox[{"Inverse", "[", 
       RowBox[{
        RowBox[{"e", " ", 
         RowBox[{"IdentityMatrix", "[", "8", "]"}]}], "-", "Hmm"}], "]"}], 
      ".", "Hma"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e", "\[Rule]", 
      RowBox[{"ts", " ", "xs"}]}], ",", 
     RowBox[{"tw", "\[Rule]", 
      RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["xs", "2"], "\[Rule]", 
        RowBox[{"S", "+", "1"}]}], ",", 
       RowBox[{
        SuperscriptBox["xs", "4"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"S", "+", "1"}], ")"}], "2"]}], ",", 
       RowBox[{
        SuperscriptBox["xs", "6"], "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"S", "+", "1"}], ")"}], "3"]}]}], "}"}]}], "//", "Expand"}],
    "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{
   SuperscriptBox["xs", "2"], "\[Rule]", 
   RowBox[{"S", "+", "1"}]}]}]}], "Input",
 CellChangeTimes->{
  3.627222662381996*^9, {3.62722446574128*^9, 3.6272244657882547`*^9}, {
   3.627277000149316*^9, 3.627277044132064*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "ts", " ", "xs", " ", 
    SuperscriptBox["\[Rho]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"S", "-", 
      SuperscriptBox["\[Rho]", "2"]}], ")"}]}], 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["S", "2"]}], "+", 
    SuperscriptBox["\[Rho]", "2"], "+", 
    RowBox[{"S", " ", 
     SuperscriptBox["\[Rho]", "2"]}]}]]}]], "Output",
 CellChangeTimes->{
  3.627222666552718*^9, 3.627222726192833*^9, {3.627224462546645*^9, 
   3.627224466353043*^9}, {3.6272769968267937`*^9, 3.627277000818797*^9}, {
   3.6272770385315123`*^9, 3.627277044406724*^9}}]
}, Open  ]],

Cell[TextData[{
 "Thus ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["V", "w"], "'"}], "=", 
    RowBox[{
     SubscriptBox["V", "w"], "-", 
     FractionBox[
      RowBox[{"2", " ", "ts", " ", "xs", " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"S", "-", 
         SuperscriptBox["\[Rho]", "2"]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["S", "2"]}], "+", 
       SuperscriptBox["\[Rho]", "2"], "+", 
       RowBox[{"S", " ", 
        SuperscriptBox["\[Rho]", "2"]}]}]]}]}], TraditionalForm]]],
 ", which can be rewritten\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["x", "w"], "'"}], "=", 
    RowBox[{
     SubscriptBox["x", "w"], "-", 
     RowBox[{"2", 
      SuperscriptBox["\[Rho]", "2"], 
      FractionBox[
       RowBox[{" ", 
        RowBox[{"S", "-", " ", 
         SuperscriptBox["\[Rho]", "2"]}]}], 
       RowBox[{
        SuperscriptBox["S", "2"], "-", 
        RowBox[{"S", " ", 
         SuperscriptBox["\[Rho]", "2"]}], "-", 
        SuperscriptBox["\[Rho]", "2"]}]], 
      SubscriptBox["x", "s"]}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.627221659377637*^9, 3.627221868706966*^9}, {
   3.627277280924081*^9, 3.627277297589716*^9}, {3.627277334215355*^9, 
   3.627277345447671*^9}, 3.6272774368316517`*^9},
 Background->GrayLevel[0.85]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 CellChangeTimes->{{3.62729432553163*^9, 3.627294330251356*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Bonding diatomic chain: strong coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"]}], "=", 
    RowBox[{
     SubscriptBox["t", "s"], "'"}]}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.627298823446986*^9, 3.627298866202854*^9}, {
  3.6272989804404497`*^9, 3.627298981943932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sq2", "=", 
   SqrtBox["2"]}], ";"}]], "Input",
 CellChangeTimes->{{3.627300122976379*^9, 3.627300130275865*^9}, {
  3.627300174851281*^9, 3.627300179299415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "bonding", " ", "state", " ", "is", " ", "the", " ", 
    "antisymmetric", " ", "combination", " ", "of", " ", "atomic", " ", 
    "orbitals", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "it", " ", "raises", " ", "the", " ", "energy", " ", "if", " ", "the", 
       " ", "exchange", " ", "integral", " ", 
       SubscriptBox["t", "s"], " ", "is", " ", "negative"}], ")"}], ".", 
     "\[IndentingNewLine]", "We"}], " ", "call", " ", "it", " ", 
    RowBox[{"b", ".", " ", "We"}], " ", "label", " ", "r", " ", "the", " ", 
    "rest", " ", "of", " ", "the", " ", 
    RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hbb", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{
            SubscriptBox["V", "s"], "-", "ts"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{
            SubscriptBox["V", "s"], "-", "ts"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrb", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hbr", "=", 
     RowBox[{"Transpose", "@", "Hrb"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"off", "-", 
     RowBox[{"diagonal", " ", "part"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Hrr", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "//", "Normal"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrr", "=", 
     RowBox[{"Hrr", "+", 
      RowBox[{"Transpose", "@", "Hrr"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"diagonal", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrr", " ", "=", " ", 
     RowBox[{"Hrr", " ", "+", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "w"]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["V", "s"], "+", "ts"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["V", "s"], "+", "ts"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "w"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6272998894800987`*^9, 3.627299900191864*^9}, {
  3.627299934721031*^9, 3.627300470601183*^9}, {3.627305042462513*^9, 
  3.6273050476140003`*^9}, {3.627305134071835*^9, 3.62730514062999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Hbb", "+", 
      RowBox[{"Hbr", ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"e", "*", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "Hrr"}], "]"}], 
       ".", "Hrb"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "s"], "\[Rule]", "0"}], ",", 
     RowBox[{
      SubscriptBox["V", "w"], "\[Rule]", "0"}], ",", 
     RowBox[{"tw", "\[Rule]", 
      RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Rho]", 
      RowBox[{"-", "1"}]], "*", "%"}], "/.", 
    RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "*", "%"}]}], "Input",
 CellChangeTimes->{{3.627300646976321*^9, 3.627300669918563*^9}, {
   3.627300707610585*^9, 3.627300713001439*^9}, {3.6273007623296013`*^9, 
   3.6273008248026752`*^9}, 3.6273009634054613`*^9, {3.627301864065954*^9, 
   3.627301878909911*^9}, {3.627302068688003*^9, 3.627302092560343*^9}, 
   3.6273021741644783`*^9, {3.627303019179421*^9, 3.62730302144795*^9}, {
   3.6273044805145817`*^9, 3.627304482881188*^9}, {3.627305207110354*^9, 
   3.627305251666716*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"ts", " ", "\[Rho]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.627300670275743*^9, 3.627300713467836*^9, 3.627300825212328*^9, 
   3.627300964090724*^9, 3.627301879492714*^9, {3.6273020746135*^9, 
   3.627302093095117*^9}, 3.627302174501089*^9, 3.627303024021703*^9, {
   3.6273044835696583`*^9, 3.627304486554982*^9}, 3.6273051528770437`*^9, {
   3.6273052178042793`*^9, 3.627305252901655*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Hbb", "+", 
      RowBox[{"Hbr", ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"e", "*", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "Hrr"}], "]"}], 
       ".", "Hrb"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "s"], "\[Rule]", "0"}], ",", 
     RowBox[{
      SubscriptBox["V", "w"], "\[Rule]", "0"}], ",", 
     RowBox[{"tw", "\[Rule]", 
      RowBox[{"\[Rho]", " ", "ts"}]}], ",", 
     RowBox[{"e", "\[Rule]", "ts"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.627363124844076*^9, 3.627363128813295*^9}, {
  3.627363167231709*^9, 3.627363175803094*^9}, {3.627363271857869*^9, 
  3.627363282972193*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"ts", "-", 
   RowBox[{"3", " ", "ts", " ", 
    SuperscriptBox["\[Rho]", "2"]}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["\[Rho]", "2"]}]]], "Output",
 CellChangeTimes->{
  3.627363129295495*^9, 3.6273631762427187`*^9, {3.627363273788259*^9, 
   3.6273632837794733`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Antibonding diatomic chain: strong coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"]}], "=", 
    RowBox[{
     SubscriptBox["t", "s"], "'"}]}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.627298823446986*^9, 3.627298866202854*^9}, {
  3.6272989804404497`*^9, 3.627298981943932*^9}, {3.627303124162294*^9, 
  3.627303129074108*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sq2", "=", 
   SqrtBox["2"]}], ";"}]], "Input",
 CellChangeTimes->{{3.627300122976379*^9, 3.627300130275865*^9}, {
  3.627300174851281*^9, 3.627300179299415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "bonding", " ", "state", " ", "is", " ", "the", " ", 
    "antisymmetric", " ", "combination", " ", "of", " ", "atomic", " ", 
    "orbitals", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "it", " ", "raises", " ", "the", " ", "energy", " ", "if", " ", "the", 
       " ", "exchange", " ", "integral", " ", 
       SubscriptBox["t", "s"], " ", "is", " ", "negative"}], ")"}], ".", 
     "\[IndentingNewLine]", "We"}], " ", "call", " ", "it", " ", 
    RowBox[{"b", ".", " ", "We"}], " ", "label", " ", "r", " ", "the", " ", 
    "rest", " ", "of", " ", "the", " ", 
    RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hbb", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{
            SubscriptBox["V", "s"], "+", "ts"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{
            SubscriptBox["V", "s"], "+", "ts"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrb", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hbr", "=", 
     RowBox[{"Transpose", "@", "Hrb"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"off", "-", 
     RowBox[{"diagonal", " ", "part"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Hrr", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "sq2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "//", "Normal"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrr", "=", 
     RowBox[{"Hrr", "+", 
      RowBox[{"Transpose", "@", "Hrr"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"diagonal", " ", "part"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrr", " ", "=", " ", 
     RowBox[{"Hrr", " ", "+", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "w"]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["V", "s"], "-", "ts"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["V", "s"], "-", "ts"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "w"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6272998894800987`*^9, 3.627299900191864*^9}, {
  3.627299934721031*^9, 3.627300470601183*^9}, {3.627303315253274*^9, 
  3.627303316101247*^9}, {3.627303392642748*^9, 3.627303472894753*^9}, {
  3.627305281921509*^9, 3.627305305288748*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Hbb", "+", 
      RowBox[{"Hbr", ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"e", "*", 
          RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "Hrr"}], "]"}], 
       ".", "Hrb"}]}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["V", "s"], "\[Rule]", "0"}], ",", 
     RowBox[{
      SubscriptBox["V", "w"], "\[Rule]", "0"}], ",", 
     RowBox[{"tw", "\[Rule]", 
      RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Rho]", 
      RowBox[{"-", "1"}]], "*", "%"}], "/.", 
    RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Rho]", "*", "%"}]}], "Input",
 CellChangeTimes->{{3.627300646976321*^9, 3.627300669918563*^9}, {
   3.627300707610585*^9, 3.627300713001439*^9}, {3.6273007623296013`*^9, 
   3.6273008248026752`*^9}, 3.6273009634054613`*^9, {3.627301864065954*^9, 
   3.627301878909911*^9}, {3.627302068688003*^9, 3.627302092560343*^9}, 
   3.6273021741644783`*^9, {3.627303019179421*^9, 3.62730302144795*^9}, {
   3.627304463411482*^9, 3.627304466081634*^9}, 3.627305263143395*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"ts", " ", "\[Rho]"}], "2"]], "Output",
 CellChangeTimes->{
  3.627300670275743*^9, 3.627300713467836*^9, 3.627300825212328*^9, 
   3.627300964090724*^9, 3.627301879492714*^9, {3.6273020746135*^9, 
   3.627302093095117*^9}, 3.627302174501089*^9, 3.627303024021703*^9, 
   3.627303482211697*^9, 3.6273044687636414`*^9, 3.6273053071944313`*^9, 
   3.627364484802926*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Bonding diatomic chain: weak coupling ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["t", "s"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "w"], 
     SubscriptBox["t", "s"]}], "=", 
    RowBox[{
     SubscriptBox["t", "w"], "'"}]}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.627298823446986*^9, 3.627298866202854*^9}, {
  3.6272989804404497`*^9, 3.627298981943932*^9}, {3.627303530020813*^9, 
  3.6273035536570263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sq2", "=", 
   SqrtBox["2"]}], ";"}]], "Input",
 CellChangeTimes->{{3.627300122976379*^9, 3.627300130275865*^9}, {
  3.627300174851281*^9, 3.627300179299415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "bonding", " ", "state", " ", "is", " ", "the", " ", 
    "antisymmetric", " ", "combination", " ", "of", " ", "atomic", " ", 
    "orbitals", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "it", " ", "raises", " ", "the", " ", "energy", " ", "if", " ", "the", 
       " ", "exchange", " ", "integral", " ", 
       SubscriptBox["t", "s"], " ", "is", " ", "negative"}], ")"}], ".", 
     "\[IndentingNewLine]", "We"}], " ", "call", " ", "it", " ", 
    RowBox[{"b", ".", " ", "We"}], " ", "label", " ", "r", " ", "the", " ", 
    "rest", " ", "of", " ", "the", " ", 
    RowBox[{"Hamiltonian", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Hbb", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{
            SubscriptBox["V", "s"], "-", "ts"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{
            SubscriptBox["V", "s"], "-", "ts"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrb", "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{
            RowBox[{"-", "tw"}], "/", "sq2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hbr", "=", 
     RowBox[{"Transpose", "@", "Hrb"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"off", "-", 
     RowBox[{"diagonal", " ", "part"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Hrr", "=", 
     RowBox[{
      RowBox[{"SparseArray", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "5"}], "}"}], "\[Rule]", 
           RowBox[{"tw", "/", "sq2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}]}], "]"}], "//", "Normal"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrr", "=", 
     RowBox[{"Hrr", "+", 
      RowBox[{"Transpose", "@", "Hrr"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"diagonal", " ", "part", " ", 
     RowBox[{"(", 
      RowBox[{"0", " ", "means", " ", "undetermined", " ", "coupling"}], 
      ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hrr", " ", "=", " ", 
     RowBox[{"Hrr", " ", "+", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "s"]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["V", "s"], "+", "ts"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "w"]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4", ",", "4"}], "}"}], "\[Rule]", 
            RowBox[{
             SubscriptBox["V", "s"], "+", "ts"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"5", ",", "5"}], "}"}], "\[Rule]", 
            SubscriptBox["V", "s"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "5"}], "}"}]}], "]"}], "]"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6272998894800987`*^9, 3.627299900191864*^9}, {
  3.627299934721031*^9, 3.627300470601183*^9}, {3.627304184137813*^9, 
  3.62730418700774*^9}, {3.6273042936888638`*^9, 3.627304356194808*^9}, {
  3.627304517442276*^9, 3.6273045364351797`*^9}, {3.627305380813555*^9, 
  3.627305465175929*^9}, {3.627305847938786*^9, 3.62730604710597*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "at", " ", "first", " ", "order", " ", "the", " ", "energy", " ", "in", 
      " ", "the", " ", "bonding", " ", "state", " ", "is", " ", "e"}], "=", 
     RowBox[{"-", "ts"}]}], ",", " ", 
    RowBox[{"so", " ", "this", " ", "may", " ", "be", " ", "OK"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Hbb", "+", 
        RowBox[{"Hbr", ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{
           RowBox[{"e", "*", 
            RowBox[{"IdentityMatrix", "[", "5", "]"}]}], "-", "Hrr"}], "]"}], 
         ".", "Hrb"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["V", "s"], "\[Rule]", "0"}], ",", 
       RowBox[{
        SubscriptBox["V", "w"], "\[Rule]", "0"}], ",", 
       RowBox[{"tw", "\[Rule]", 
        RowBox[{"\[Rho]", " ", "ts"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Rho]", 
       RowBox[{"-", "2"}]], "*", "%"}], "/.", 
     RowBox[{"\[Rho]", "\[Rule]", "0"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Rho]", "2"], "%"}], "//", "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.627300646976321*^9, 3.627300669918563*^9}, {
   3.627300707610585*^9, 3.627300713001439*^9}, {3.6273007623296013`*^9, 
   3.6273008248026752`*^9}, 3.6273009634054613`*^9, {3.627301864065954*^9, 
   3.627301878909911*^9}, {3.627302068688003*^9, 3.627302092560343*^9}, 
   3.6273021741644783`*^9, {3.627303019179421*^9, 3.62730302144795*^9}, 
   3.627304540993877*^9, {3.627304703477747*^9, 3.627304706707388*^9}, {
   3.627306054619557*^9, 3.627306106520047*^9}, {3.627306157565097*^9, 
   3.6273061808446913`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["ts", "2"], " ", 
    SuperscriptBox["\[Rho]", "2"]}], 
   RowBox[{"2", " ", "e"}]]}]], "Output",
 CellChangeTimes->{
  3.627300670275743*^9, 3.627300713467836*^9, 3.627300825212328*^9, 
   3.627300964090724*^9, 3.627301879492714*^9, {3.6273020746135*^9, 
   3.627302093095117*^9}, 3.627302174501089*^9, 3.627303024021703*^9, 
   3.6273045423866873`*^9, 3.62730470832512*^9, 3.627305431353739*^9, 
   3.627305467041912*^9, {3.627306048810658*^9, 3.627306055285667*^9}, {
   3.62730608532479*^9, 3.627306107124399*^9}, 3.627306159601842*^9, 
   3.627306329349802*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Solve", "[", "{"}]], "Input",
 CellChangeTimes->{{3.6273672770601587`*^9, 3.62736727839002*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1015},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 101, 1, 55, "Subsection"],
Cell[CellGroupData[{
Cell[706, 27, 545, 17, 43, "Subsubsection"],
Cell[1254, 46, 613, 16, 166, "Text"],
Cell[1870, 64, 883, 26, 172, "Input"],
Cell[CellGroupData[{
Cell[2778, 94, 413, 10, 72, "Input"],
Cell[3194, 106, 2783, 84, 222, "Output"]
}, Open  ]],
Cell[5992, 193, 392, 8, 72, "Input"],
Cell[CellGroupData[{
Cell[6409, 205, 508, 14, 72, "Input"],
Cell[6920, 221, 234, 5, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7191, 231, 1443, 43, 231, "Input"],
Cell[8637, 276, 337, 10, 140, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[9023, 292, 436, 14, 34, "Subsubsection"],
Cell[9462, 308, 682, 23, 172, "Input"],
Cell[CellGroupData[{
Cell[10169, 335, 416, 10, 72, "Input"],
Cell[10588, 347, 1491, 44, 183, "Output"]
}, Open  ]],
Cell[12094, 394, 392, 8, 72, "Input"],
Cell[CellGroupData[{
Cell[12511, 406, 506, 14, 72, "Input"],
Cell[13020, 422, 281, 6, 128, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13338, 433, 1175, 34, 231, "Input"],
Cell[14516, 469, 268, 6, 128, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[14833, 481, 1055, 37, 34, "Subsubsection"],
Cell[15891, 520, 1832, 54, 221, "Input"],
Cell[17726, 576, 795, 21, 166, "Text"],
Cell[CellGroupData[{
Cell[18546, 601, 476, 11, 72, "Input"],
Cell[19025, 614, 8965, 259, 321, "Output"]
}, Open  ]],
Cell[28005, 876, 1641, 51, 325, "Text"],
Cell[CellGroupData[{
Cell[29671, 931, 1521, 48, 235, "Input"],
Cell[31195, 981, 636, 20, 156, "Output"]
}, Open  ]],
Cell[31846, 1004, 1915, 66, 321, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[33798, 1075, 1034, 36, 34, "Subsubsection"],
Cell[34835, 1113, 3789, 105, 320, "Input"],
Cell[CellGroupData[{
Cell[38649, 1222, 806, 20, 125, "Input"],
Cell[39458, 1244, 4420, 133, 356, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43915, 1382, 1499, 48, 235, "Input"],
Cell[45417, 1432, 623, 17, 145, "Output"]
}, Open  ]],
Cell[46055, 1452, 1398, 45, 257, "Text"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47502, 1503, 92, 1, 55, "Subsection"],
Cell[CellGroupData[{
Cell[47619, 1508, 416, 13, 43, "Subsubsection"],
Cell[48038, 1523, 197, 5, 45, "Input"],
Cell[48238, 1530, 5006, 141, 283, "Input"],
Cell[CellGroupData[{
Cell[53269, 1675, 1460, 40, 121, "Input"],
Cell[54732, 1717, 453, 9, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55222, 1731, 910, 27, 67, "Input"],
Cell[56135, 1760, 331, 10, 65, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56515, 1776, 469, 14, 43, "Subsubsection"],
Cell[56987, 1792, 197, 5, 45, "Input"],
Cell[57187, 1799, 5054, 142, 283, "Input"],
Cell[CellGroupData[{
Cell[62266, 1945, 1430, 39, 121, "Input"],
Cell[63699, 1986, 406, 8, 56, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64154, 2000, 495, 15, 43, "Subsubsection"],
Cell[64652, 2017, 197, 5, 45, "Input"],
Cell[64852, 2024, 5245, 145, 283, "Input"],
Cell[CellGroupData[{
Cell[70122, 2173, 1997, 52, 148, "Input"],
Cell[72122, 2227, 641, 14, 60, "Output"]
}, Open  ]],
Cell[72778, 2244, 120, 2, 39, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
