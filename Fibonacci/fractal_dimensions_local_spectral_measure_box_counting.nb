(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9066,        279]
NotebookOptionsPosition[      8095,        240]
NotebookOutlinePosition[      8430,        255]
CellTagsIndexPosition[      8387,        252]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spectrum, eigenstates for a large approximant", "Section",
 CellChangeTimes->{{3.644300481076283*^9, 3.644300490695801*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Fibonacci", " ", "Hamiltonian"}], ",", " ", 
    RowBox[{
     RowBox[{"in", " ", "the", " ", "co"}], "-", "basis"}], ",", " ", 
    RowBox[{"with", " ", "periodic", " ", "bc"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"hp", "[", 
    RowBox[{"n_", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"F0", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "-", "2"}], "]"}]}], ",", 
       RowBox[{"F1", "=", 
        RowBox[{"Fibonacci", "[", 
         RowBox[{"n", "-", "1"}], "]"}]}], ",", 
       RowBox[{"F2", "=", 
        RowBox[{"Fibonacci", "[", "n", "]"}]}], ",", "tblw", ",", "tbls", ",",
        "ar"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tblw", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F0"}]}], "}"}], "\[Rule]", "\[Rho]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "F1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tbls", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"i", "+", "F1"}]}], "}"}], "\[Rule]", "1."}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "F0"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ar", "=", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"tblw", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}], "+", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"tbls", ",", 
          RowBox[{"{", 
           RowBox[{"F2", ",", "F2"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Normal", "[", 
       RowBox[{"ar", "+", 
        RowBox[{"Transpose", "[", "ar", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.626500989913364*^9, 3.6265010439825687`*^9}, {
   3.6265010838140287`*^9, 3.6265011556879473`*^9}, {3.626501188073691*^9, 
   3.626501251376388*^9}, {3.626501282361532*^9, 3.626501308767273*^9}, {
   3.6265013837286673`*^9, 3.626501388405682*^9}, {3.6297117308094873`*^9, 
   3.629711744441989*^9}, {3.629712260739542*^9, 3.6297122613888474`*^9}, {
   3.629712372304244*^9, 3.629712372429983*^9}, 3.6313353026608963`*^9, {
   3.6443005186948853`*^9, 3.644300540874257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fibonacci", "[", "20", "]"}]], "Input",
 CellChangeTimes->{{3.644300577470104*^9, 3.6443005992511*^9}}],

Cell[BoxData["6765"], "Output",
 CellChangeTimes->{{3.644300581292078*^9, 3.644300600005781*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valvec", "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"hp", "[", 
     RowBox[{"n", ",", "\[Rho]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6443005651807137`*^9, 3.644300574199812*^9}, {
  3.644300604338602*^9, 3.644300631455792*^9}, {3.6443017171374407`*^9, 
  3.644301723549773*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "20"}]], "Input",
 CellChangeTimes->{{3.644301811051722*^9, 3.644301812041483*^9}}],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{3.6443018125264387`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"directory", " ", "and", " ", "filename"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dir", "=", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<data/spectrum_eigenstates/n_20_rho_05.dat\>\""}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "header", " ", "to", " ", "be", " ", "prepended", " ", "to", " ", "the", 
     " ", "data", " ", "file"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"header", "=", 
     RowBox[{
     "\"\<** This is the eigensvalues and the eigenfunctions of the \
approximant n=\>\"", "<>", 
      RowBox[{"ToString", "[", "n", "]"}], "<>", 
      "\"\< of the Fibonacci chain, with periodic bc, and with nearest \
neighbours hopping amplitudes set to 1 and rho=\>\"", "<>", 
      RowBox[{"ToString", "[", "\[Rho]", "]"}], "<>", 
      "\"\<, and no on-site potential. \\n This file contains a list of the \
form {val, vec} where val is the list of eigenvalues (not necesarily sorted), \
and vec[[i]] is the list components of the eigenvector associated to \
val[[i]]. **\>\""}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{"dir", ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", "valvec", "}"}], "}"}], ",", 
        RowBox[{"{", "header", "}"}]}], "]"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.644300641295023*^9, 3.644300761018549*^9}, {
   3.644301164149438*^9, 3.644301464959655*^9}, {3.6443015667967978`*^9, 
   3.644301622549759*^9}, 3.644301806315242*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dat", "=", 
  RowBox[{"Import", "[", "fn", "]"}]}]], "Input",
 CellChangeTimes->{{3.644300944093322*^9, 3.644300948871572*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "\<\"**Header 1 **\"\>", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"{1,\"\>", ",", "\<\"2,\"\>", ",", "\<\"3,\"\>", 
     ",", "\<\"4,\"\>", ",", "\<\"5,\"\>", ",", "\<\"6,\"\>", 
     ",", "\<\"7,\"\>", ",", "\<\"8,\"\>", ",", "\<\"9,\"\>", 
     ",", "\<\"10}\"\>"}], "}"}], ",", 
   RowBox[{"{", "\<\"**Trailer 1 **\"\>", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6443009494169407`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "10"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.644300996212825*^9, 3.644301004706793*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "=", 
  RowBox[{"Prepend", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", "data", "}"}], "}"}], ",", 
    RowBox[{"{", "\"\<**Header 1 **\>\"", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.644301006168653*^9, 3.64430106809385*^9}, {
  3.6443011198400183`*^9, 3.644301122477013*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "\<\"**Header 1 **\"\>", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
      "8", ",", "9", ",", "10"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6443010284374933`*^9, 3.644301071334236*^9}, 
   3.6443011263924503`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<data/spectrum_eigenstates/test2.dat\>\""}], ",", "data"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.644301088918977*^9, 3.644301103934133*^9}}],

Cell[BoxData["\<\"/home/nicolas/git/spectrum_quasicrystals/Fibonacci/data/\
spectrum_eigenstates/test2.dat\"\>"], "Output",
 CellChangeTimes->{{3.6443011044600477`*^9, 3.644301129584908*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1021},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 130, 1, 64, "Section"],
Cell[713, 25, 2572, 67, 165, "Input"],
Cell[CellGroupData[{
Cell[3310, 96, 127, 2, 32, "Input"],
Cell[3440, 100, 97, 1, 32, "Output"]
}, Open  ]],
Cell[3552, 104, 487, 12, 77, "Input"],
Cell[CellGroupData[{
Cell[4064, 120, 116, 2, 32, "Input"],
Cell[4183, 124, 73, 1, 32, "Output"]
}, Open  ]],
Cell[4271, 128, 1666, 39, 187, "Input"],
Cell[CellGroupData[{
Cell[5962, 171, 151, 3, 32, "Input"],
Cell[6116, 176, 455, 10, 32, "Output"]
}, Open  ]],
Cell[6586, 189, 248, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[6859, 200, 325, 8, 32, "Input"],
Cell[7187, 210, 382, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7606, 225, 267, 7, 32, "Input"],
Cell[7876, 234, 191, 2, 32, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
