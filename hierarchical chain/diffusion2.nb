(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     31645,        790]
NotebookOptionsPosition[     30394,        742]
NotebookOutlinePosition[     30750,        758]
CellTagsIndexPosition[     30707,        755]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"<", 
    RowBox[{
     SuperscriptBox["r", "2"], "(", "t", ")"}], ">"}], TraditionalForm]]],
 ", calcul num\[EAcute]rique"
}], "Section",
 CellChangeTimes->{{3.6240006886177464`*^9, 3.624000709603354*^9}}],

Cell[CellGroupData[{

Cell["\[CapitalEAcute]tats propres dans la base atomique", "Subsection",
 CellChangeTimes->{{3.6240007308943443`*^9, 3.6240007431664057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "amplitude", " ", "de", " ", "saut", " ", "entre", " ", "les", " ", 
     "sites", " ", "atomiques", " ", "i", " ", "et", " ", "i"}], "+", "1"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", 
     RowBox[{"A", ",", "v", ",", "r"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"i_", ",", "v_", ",", "r_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "tt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"IntegerExponent", "[", 
         RowBox[{"i", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", "\[Equal]", "0"}], ",", 
         RowBox[{"tt", "=", "1"}], ",", 
         RowBox[{"tt", "=", 
          RowBox[{"v", " ", 
           SuperscriptBox["r", 
            RowBox[{"k", "-", "1"}]]}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "tt"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6211679999582233`*^9, 3.621168134325338*^9}, {
  3.621168458751822*^9, 3.621168472552882*^9}, {3.621168519675881*^9, 
  3.621168549275285*^9}, {3.6211686223969097`*^9, 3.621168644998843*^9}, {
  3.6211687319432173`*^9, 3.621168734615151*^9}, {3.621169102780929*^9, 
  3.621169105022097*^9}, {3.62416631046133*^9, 3.624166315140324*^9}, {
  3.624337813068297*^9, 3.6243378300157413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "hamiltonien", " ", "avec", " ", "conditions", " ", "aux", " ", "bords", 
    " ", "libres"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "h", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"n_", ",", "v_", ",", "r_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tbl", ",", "ar"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tbl", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"i", "+", "1"}]}], "}"}], "\[Rule]", 
           RowBox[{"A", "[", 
            RowBox[{"i", ",", "v", ",", "r"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{
             SuperscriptBox["2", "n"], "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ar", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{"tbl", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["2", "n"], ",", 
            SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{"ar", "+", 
         RowBox[{"Transpose", "[", "ar", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6211684819135237`*^9, 3.6211684988856583`*^9}, {
  3.621168559429494*^9, 3.621168599686886*^9}, {3.62116867296889*^9, 
  3.621168725036395*^9}, {3.621168764298398*^9, 3.621168815675806*^9}, {
  3.6211688527164*^9, 3.621168914476056*^9}, {3.621168955102767*^9, 
  3.621169020992931*^9}, {3.621169062764553*^9, 3.6211690985108767`*^9}, {
  3.6211697952057056`*^9, 3.621169799843378*^9}, {3.621250086580373*^9, 
  3.621250092914645*^9}, {3.621574042613912*^9, 3.6215740570107183`*^9}, {
  3.6243378368970127`*^9, 3.624337844600925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "\[EAcute]tats", " ", "propres", " ", "et", " ", "leurs", " ", 
    "\[EAcute]nergies", " ", "dans", " ", "la", " ", "base", " ", 
    "atomique"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"valvec", "[", 
    RowBox[{"v_", ",", "r_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"h", "[", 
     RowBox[{"i", ",", "v", ",", "r"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6240008337796307`*^9, 3.624000844558497*^9}, {
  3.624000878308483*^9, 3.624000955838241*^9}, {3.624165916574751*^9, 
  3.624165921134645*^9}, {3.624337857021954*^9, 3.624337876883094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "le", " ", "spectre", " ", "est", " ", "bien", " ", "comme", " ", "on", 
    " ", 
    RowBox[{"l", "'"}], "attend"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"valvec", "[", 
      RowBox[{".9", ",", ".9", ",", "6"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624000958935536*^9, 3.624000976543419*^9}, {
  3.624001178731003*^9, 3.6240012028015957`*^9}, {3.624165926486253*^9, 
  3.6241659296872997`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw1k11IU2EcxlfzYhclBSIFgbZK1gxx1uzD2Z59uuk23TKloqgoujGiD8Qo
wYsCMwkhC7tIg0C8iKJVftDFxC5qSQZambAgckWY+LHFXNo3/+c9cDj8zu9w
znv+7/OsP3oqdHy5RqPBv/P/VY456+fg2m+Dpb8ivIHbSyveZBYo1uHZGac3
tUzxKjSuPpe9OPmTnIWzG96Gq04qXoOFSFQ7na94HbTzk9YPI0vkXDwIdTt6
bijWY5/bUms/uEjeCIc+P2s48YOch1vjxZakX7EBB2a7mo3RNNmITUPBzu6J
BfIWjMWqIq4SxQXoMz8/ZG1NkQthmggM6XIUmzDsy/boDUlyEVYOtB/pa0mQ
t6JW23b42vV58jbsCfoLZiNzZDNa7FMZ8acz5GJ09r+w+IanyduRyhgYNzZO
kXfgZtt+88Xer+Sd6HXOVN+7EyfvQv35wc36R5/IJchLfPljwEeyBXVXrtru
18TIpXhc/WQkfOkdeTda62InLr8eJVvRkGNKfx97RQbSF4z16cKocBPwXtgq
3oZmeV64yYZ2eR+9HT3yPXo7jsl66B1qvfQONMj/0DsRlv+ld6JD5kHvQlLm
Re/CXZknvVvNm96NkOwHfZnaL/oyZMp+0nvwUvab3oMiyQO9V+WF3otRyRN9
OXIlb/Tl2Ct5pK9Ah+SVvgIuyTO9DzWSd3ofHkof6P3QSV/o/fgtfaIP4LT0
jT6g+khfiaj0lb4SXdJn+irEpe/Wv4CVRc0=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.},
  Method->{},
  PlotRange->{{0, 64.}, {-1.8275765594054232`, 1.827576559405423}},
  PlotRangeClipping->True,
  PlotRangePadding->{{1.28, 1.28}, {0.07310306237621692, 
   0.07310306237621692}}]], "Output",
 CellChangeTimes->{
  3.62400097717162*^9, 3.624165302994223*^9, {3.6241659274969378`*^9, 
   3.624165929964628*^9}, 3.624337142452221*^9, 3.6243378872979927`*^9, 
   3.624341672790224*^9, 3.62437051067094*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "les", " ", "vecteurs", " ", "propres", " ", "sont", " ", "bien", " ", 
    "normalis\[EAcute]s", " ", "\[AGrave]", " ", "1"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Norm", "/@", 
   RowBox[{
    RowBox[{"valvec", "[", 
     RowBox[{".1", ",", ".001", ",", "5"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6240010017462063`*^9, 3.624001107530616*^9}, {
  3.624001140173484*^9, 3.624001143588745*^9}, {3.624001213568622*^9, 
  3.624001216109373*^9}, {3.624165935430455*^9, 3.624165935887926*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9999999999999999`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "0.9999999999999999`", ",", "0.9999999999999999`", ",", "1.`", 
   ",", "1.`", ",", "0.9999999999999999`", ",", "0.9999999999999999`", ",", 
   "1.0000000000000002`", ",", "0.9999999999999999`", ",", "1.`", ",", "1.`", 
   ",", "1.`", ",", "1.`", ",", "0.9999999999999999`", ",", "1.`", ",", "1.`",
    ",", "1.`", ",", "1.`", ",", "0.9999999999999999`", ",", 
   "0.9999999999999998`", ",", "0.9999999999999998`", ",", 
   "0.9999999999999999`", ",", "1.0000000000000002`", ",", "1.`", ",", "1.`", 
   ",", "1.`", ",", "1.0000000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{{3.624001044057966*^9, 3.624001107849813*^9}, 
   3.624001143921712*^9, {3.6240012138194723`*^9, 3.6240012164100027`*^9}, 
   3.624165306947117*^9, 3.624165936132028*^9, 3.6243371424763002`*^9, 
   3.624337893287672*^9, 3.624341676440847*^9, 3.624370513818533*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"attention", " ", "!"}], " ", "on", " ", "fixe", " ", "les", " ", 
    "couplages", " ", "et", " ", "la", " ", "taille", " ", "du", " ", 
    RowBox[{"syst\[EGrave]me", " ", "!"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rmoy", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", "7"}], ",", 
        RowBox[{"v", "=", ".3"}], ",", 
        RowBox[{"r", "=", ".3"}], ",", "val", ",", "vec", ",", "K", ",", 
        RowBox[{"tmax", "=", "40"}], ",", 
        RowBox[{"dt", "=", ".5"}], ",", "timelist", ",", "rmoy", ",", "d", 
        ",", "dtot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "on", " ", "prend", " ", "des", " ", "distances", " ", "entre", " ", 
        "sites", " ", "ppv", " ", "proportionnelles", " ", "aux", " ", 
        "amplitudes", " ", "de", " ", "saut"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"on", " ", "place", " ", 
        RowBox[{"l", "'"}], "origine", " ", "au", " ", "bord", " ", "gauche", 
        " ", "de", " ", "la", " ", "cha\[IHat]ne"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dtot", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"i", ",", "v", ",", "r"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{
         SuperscriptBox["dtot", 
          RowBox[{"-", "1"}]], 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"i", ",", "v", ",", "r"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"val", ",", "vec"}], "}"}], "=", 
        RowBox[{"valvec", "[", 
         RowBox[{"v", ",", "r", ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"timelist", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "tmax", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"matrice", " ", 
         RowBox[{"K", " ", ":", " ", "propagateur"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"K", "=", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", "t", " ", 
               RowBox[{"val", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Conjugate", "[", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "timelist"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            SuperscriptBox["2", "n"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"diffusion", " ", ":", " ", 
          RowBox[{"<", 
           SuperscriptBox["r", "2"], 
           SubscriptBox[">", "i"]}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["\[CapitalSigma]", "j"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["d", "j"], "-", 
             SubscriptBox["d", "i"]}], ")"}], "2"], 
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["K", "*"], ")"}], "ji"], 
          SubscriptBox["K", "ji"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rmoy", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "-", 
                 RowBox[{"d", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
               RowBox[{"K", "[", 
                RowBox[{"[", 
                 RowBox[{"timeIt", ",", "j", ",", "i"}], "]"}], "]"}]}], 
              "]"}], "2"], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            SuperscriptBox["2", "n"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"timeIt", ",", 
            RowBox[{"Length", "@", "timelist"}]}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6241655404096737`*^9, 3.62416555997062*^9}, {
   3.624165686909739*^9, 3.6241657979845057`*^9}, {3.624165837277454*^9, 
   3.624165905044333*^9}, {3.624165942296335*^9, 3.62416604107626*^9}, {
   3.624166120891347*^9, 3.6241661391143503`*^9}, {3.6241661832355957`*^9, 
   3.6241661834385643`*^9}, {3.624166289243436*^9, 3.624166293367022*^9}, {
   3.624166337485482*^9, 3.624166358687338*^9}, {3.624337988071163*^9, 
   3.624338074101118*^9}, {3.62433811796913*^9, 3.624338182804481*^9}, {
   3.6243383297937202`*^9, 3.624338337810973*^9}, {3.624338527682569*^9, 
   3.624338874659046*^9}, {3.624339028573332*^9, 3.624339068660796*^9}, {
   3.624339143120109*^9, 3.6243391456484118`*^9}, {3.624341593080207*^9, 
   3.6243416452407846`*^9}, {3.624341775293106*^9, 3.6243417852417173`*^9}, {
   3.6243418374183407`*^9, 3.624341852154516*^9}, {3.624341940541038*^9, 
   3.624341970650854*^9}, 3.624342003535357*^9, {3.624342091485209*^9, 
   3.624342123324649*^9}, {3.6243422929577637`*^9, 3.624342336077759*^9}, 
   3.6243423696187696`*^9, {3.6243424198545218`*^9, 3.624342443455282*^9}, 
   3.6243426237621*^9, {3.624342713058877*^9, 3.624342713200058*^9}, {
   3.6243427913776627`*^9, 3.624342792592257*^9}, {3.624342851988019*^9, 
   3.624342855250478*^9}, {3.6243434701026087`*^9, 3.624343500565246*^9}, {
   3.624343587400228*^9, 3.624343592214218*^9}, 3.624343763752964*^9, {
   3.624343876584672*^9, 3.6243438809530888`*^9}, {3.6243458784872427`*^9, 
   3.624345887142598*^9}, {3.62434599643795*^9, 3.6243460227602463`*^9}, {
   3.624346153785924*^9, 3.624346188152768*^9}, {3.624346225097671*^9, 
   3.624346226890497*^9}, {3.624346311642404*^9, 3.624346337537373*^9}, {
   3.624370569941265*^9, 3.624370592196578*^9}, {3.624370659203391*^9, 
   3.624370678764449*^9}, {3.624370723155054*^9, 3.624370723356278*^9}, 
   3.624372457676776*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"rmoy", "[", 
    RowBox[{"[", 
     SuperscriptBox["2", "6"], "]"}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.624343543115971*^9, 3.6243435524085817`*^9}, {
   3.624343643609014*^9, 3.6243436452251596`*^9}, {3.624370704325222*^9, 
   3.624370709997677*^9}, {3.624374035236904*^9, 3.624374035622945*^9}, 
   3.624374126393252*^9, {3.624374191026873*^9, 3.624374199308072*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], LineBox[CompressedData["
1:eJw1zwtMU2cYBuDjtHNoGolawIFyEVtABrajUOjtLZQ7hdMWXECLUfG6EMXr
UMlqcEE2Ak4gU4oIatxSMdFMHdMswAAb8FJvibjUgWI0LmAgiiBgui39/iYn
zXPe837/9wdv2GHa9AnHccb/nv//Pb9R7SF78DVp1et4eoFAQ6H0t9nHNB5+
hrSg41lh/G2yN8aUGR/8PwyTF8Nty37+aQen9dgP1XHl4Za2eeQAzMq5auYF
3uQglAwfXvIwegE5BNP12wY/VgnJoWhYXXx0TLGQLMYzrbP0CR9ADoNAMXfs
xWgoOQKOt4YfHK5wciTqlonuvVgbQY5C4Pz1K34+KyGvguh2+bh7hZgsRdR3
++ZE97K+DJLJjfppgZT8JSqLzl9ZysnJMRiQOfvupMSS5ViuWylvtsWQY7H+
1LN2QZGMHAeXvEo1YWVWQFnQI0w5w+bF44D9nMFxJp6cgGL+ouVijZKsxKnt
I8LVXyeQVXBxduFeLwVZDdfz/kVtmjiyBpausqjJVWyeFmV/dp9WrVGRgerL
JU86gzQeW4ErXlU++WY15TrUj7/ZWaOl8606TM5y+zflsfMT0Rj+WNrlZHki
mo4t74uvo3lcEnak3R2pEIPyJPSIGj8fatBSrsfAr/Nv7c6j86x69ParQ153
svsmo8CvlBs5Qvtak+HTukQxEcH6KSioCbjZ3cPmp0AbG+QvekTmUrHFZRuz
bKbvraloadXbay+w+6fhdzlvv97N9k/DtbpLwvw97P7pkOw/6cyWsPnpiNnU
9LRlks3PgI/6x3quguUZeFih2/XqCLt/Jryry5rvn2T7Z8J3Zqo2eJqdn4Vt
IdxgYSHbLwtDWfKVvu/ZfAMa349UtpfrKDdAHF1ov2Ehc9lYOHhvbbuG5dnY
2buhI/oOy3Mw9ebvP2RTiZTnIGFmq7svUk85D/XeSmfJ7GSPwcO+LvbpwAOy
lccjZ8DwvMxUjzt4hH0xOvHXiXTqG/GTd5f725lM6hsxff/VQcdWA/WNSCod
MpX/Qu4wot/2Dof7yZwJ//gefan6Pof6JhzffDa02WakvgmOyGBBaaeZ+iZs
8YprPeiXR30zrh4aNtoXkGGG7DJ/XqnOpb4Zbf6Vly6Ms74ZxSGBDXMkrJ+L
ohY/sWj/V9TPxdva1N2N3+Rr/wXQ6lU6
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 81.}, {0, 0.0015546348414485738`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{1.62, 1.62}, {0.00003109269682897148, 
   0.00003109269682897148}}]], "Output",
 CellChangeTimes->{
  3.6243436456538467`*^9, 3.624344773733186*^9, 3.624346107253344*^9, 
   3.624346265617278*^9, 3.624346375015098*^9, 3.624370550242032*^9, {
   3.624370649139653*^9, 3.62437073275202*^9}, {3.6243740282707043`*^9, 
   3.6243740362620087`*^9}, 3.6243741272375517`*^9, {3.624374191641695*^9, 
   3.624374200975245*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"i", ",", ".3", ",", ".3"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     SuperscriptBox["2", "7"]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6243741529250526`*^9, 3.6243741680649347`*^9}}],

Cell[BoxData["75.29420769999999`"], "Output",
 CellChangeTimes->{{3.624374159892116*^9, 3.6243741684970303`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"rmoy", "[", 
   RowBox[{"[", "17", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.624346276105653*^9, {3.624346791055234*^9, 3.624346882493785*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJw10XlMk3ccx/Fq0BCJUiZTphLxQjOUQ5C77QdqoaXl6FPqwQICBiVyg6FF
tBaDMgiHB3JUrRIO8SBsbjEzMwhDHYSoeCASq4gHVtQoeASKmdPw/T3Jkyev
5/37PP88SxIzuKTpPB5P+e3+/py63otqr+VXjf/61I9eYFnZxQuXTHzRFK0x
mpLMyfkeZD6utTYmlWYGk+2R47s5o7NeQXaAA2+s5FCRkrwIHze1G+22c2Qn
2PU68074qshL4Wdssk7SbCQvR3JLkLYiIp7sjCbHrps+rtvIq/CKv8yh0DmF
/DPM9k49lntp5NX4KzBucvhWOtkVN34pirVMzyS7w/r0yA/++iyyB8SKlp70
+znktdjcenxYoMoleyJ0ILpuUqgle+HqUKb4bGweeR1a+n1GGkaZvXHqfECD
JXkX2Qcdpjpd9tx8si/G3s7x77bZTfZD1WGDJyfYQ/bHneMzeydSdOQAXBb3
deVK95ID8c/TL8LrRmYB2mRb758pZBbC5mvaaJqaWYREb2HK9gxmYH7duTWS
EbIe8EqP734i0VMPQqKV1txYQNYHIWvn2TdJ1awH47V0W7tLJevB+Dt/Raq6
nHUxVlYNGWMOsi5GqV+reVYN6+sR4l3s0l/P+nr8dEXsVn+JdQkmXV9fkA+y
LsFs8Q6dil9APQQb+iz7LgrI+hDszbP/d2AD66FQqJ/JJBzrofgvcwbf3pN1
KWYHac8vmMO6FCfbO3oFs1iXwVDcZEiLYF2GxrV2FWUm1sPweMhrwZ+afdTD
YHJPEI23kXly7EzVZHvoWJcjofyP/uFPbK+A4M7l5k3d7PsKHJm2xephIduH
48Ckolw+v5B6OJrVJYrEK/upR2DaucGcgZoD1CNQ2SSJKdhK5kXC7fFY3tc+
Oq+PxEet44N8J9aj8Fwg1bz6VDRlRCEwd2Nbp7mEzkdhcPSlZ85vZVNuj/r2
P7zdfFdX0F6JvBkNju+VZChxBqkTVkKyXoktn81xppUHaa9EZ0zXC/H+Q7Tn
sHvoRJyN+gjtOSRM6Jo7nlTSnsPtrpkP57UepT0H29iF47JHZJ4Kd9+9Ndha
yFDh2OI4fUBxFe1VcG/RxP9orKa9Cjc+GB+YTTW0j8aXxTrdmru1tI9G7e/Z
hp5wg+h/uLtuyQ==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 81.}, {0, 0.025687390615233594`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{1.62, 1.62}, {0.0005137478123046719, 
   0.0005137478123046719}}]], "Output",
 CellChangeTimes->{
  3.624346276376691*^9, 3.624346383139882*^9, {3.624346791338916*^9, 
   3.62434688285935*^9}, 3.624370810710669*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"attention", " ", "!"}], " ", "on", " ", "fixe", " ", "les", " ", 
    "couplages", " ", "et", " ", "la", " ", "taille", " ", "du", " ", 
    RowBox[{"syst\[EGrave]me", " ", "!"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"rper", "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", "7"}], ",", 
        RowBox[{"v", "=", "1."}], ",", 
        RowBox[{"r", "=", "1."}], ",", "val", ",", "vec", ",", "K", ",", 
        RowBox[{"tmax", "=", "20"}], ",", 
        RowBox[{"dt", "=", ".5"}], ",", "timelist", ",", "rmoy", ",", "d", 
        ",", "dtot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "on", " ", "prend", " ", "des", " ", "distances", " ", "entre", " ", 
        "sites", " ", "ppv", " ", "proportionnelles", " ", "aux", " ", 
        "amplitudes", " ", "de", " ", "saut"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"on", " ", "place", " ", 
        RowBox[{"l", "'"}], "origine", " ", "au", " ", "bord", " ", "gauche", 
        " ", "de", " ", "la", " ", "cha\[IHat]ne"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dtot", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"i", ",", "v", ",", "r"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{
         SuperscriptBox["dtot", 
          RowBox[{"-", "1"}]], 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"i", ",", "v", ",", "r"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"val", ",", "vec"}], "}"}], "=", 
        RowBox[{"valvec", "[", 
         RowBox[{"v", ",", "r", ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"timelist", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "tmax", ",", "dt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"matrice", " ", 
         RowBox[{"K", " ", ":", " ", "propagateur"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"K", "=", 
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", "t", " ", 
               RowBox[{"val", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "*", 
             RowBox[{
              RowBox[{"vec", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "*", 
             RowBox[{"Conjugate", "[", 
              RowBox[{
               RowBox[{"vec", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "timelist"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            SuperscriptBox["2", "n"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"diffusion", " ", ":", " ", 
          RowBox[{"<", 
           SuperscriptBox["r", "2"], 
           SubscriptBox[">", "i"]}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["\[CapitalSigma]", "j"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["d", "j"], "-", 
             SubscriptBox["d", "i"]}], ")"}], "2"], 
          SubscriptBox[
           RowBox[{"(", 
            SuperscriptBox["K", "*"], ")"}], "ji"], 
          SubscriptBox["K", "ji"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rmoy", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "-", 
                 RowBox[{"d", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}], 
               RowBox[{"K", "[", 
                RowBox[{"[", 
                 RowBox[{"timeIt", ",", "j", ",", "i"}], "]"}], "]"}]}], 
              "]"}], "2"], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            SuperscriptBox["2", "n"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"timeIt", ",", 
            RowBox[{"Length", "@", "timelist"}]}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6241655404096737`*^9, 3.62416555997062*^9}, {
   3.624165686909739*^9, 3.6241657979845057`*^9}, {3.624165837277454*^9, 
   3.624165905044333*^9}, {3.624165942296335*^9, 3.62416604107626*^9}, {
   3.624166120891347*^9, 3.6241661391143503`*^9}, {3.6241661832355957`*^9, 
   3.6241661834385643`*^9}, {3.624166289243436*^9, 3.624166293367022*^9}, {
   3.624166337485482*^9, 3.624166358687338*^9}, {3.624337988071163*^9, 
   3.624338074101118*^9}, {3.62433811796913*^9, 3.624338182804481*^9}, {
   3.6243383297937202`*^9, 3.624338337810973*^9}, {3.624338527682569*^9, 
   3.624338874659046*^9}, {3.624339028573332*^9, 3.624339068660796*^9}, {
   3.624339143120109*^9, 3.6243391456484118`*^9}, {3.624341593080207*^9, 
   3.6243416452407846`*^9}, {3.624341775293106*^9, 3.6243417852417173`*^9}, {
   3.6243418374183407`*^9, 3.624341852154516*^9}, {3.624341940541038*^9, 
   3.624341970650854*^9}, 3.624342003535357*^9, {3.624342091485209*^9, 
   3.624342123324649*^9}, {3.6243422929577637`*^9, 3.624342336077759*^9}, 
   3.6243423696187696`*^9, {3.6243424198545218`*^9, 3.624342443455282*^9}, 
   3.6243426237621*^9, {3.624342713058877*^9, 3.624342713200058*^9}, {
   3.6243427913776627`*^9, 3.624342792592257*^9}, {3.624342851988019*^9, 
   3.624342855250478*^9}, {3.6243434701026087`*^9, 3.624343500565246*^9}, {
   3.624343587400228*^9, 3.624343592214218*^9}, 3.624343763752964*^9, {
   3.624343876584672*^9, 3.6243438809530888`*^9}, {3.6243458784872427`*^9, 
   3.624345887142598*^9}, {3.62434599643795*^9, 3.6243460227602463`*^9}, {
   3.624346153785924*^9, 3.624346188152768*^9}, {3.624346225097671*^9, 
   3.624346226890497*^9}, {3.624346311642404*^9, 3.624346337537373*^9}, {
   3.6243471889793243`*^9, 3.624347195775942*^9}, {3.6243708296275997`*^9, 
   3.624370842449275*^9}, {3.624374233079432*^9, 3.6243742415924797`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"rper", "[", 
    RowBox[{"[", 
     SuperscriptBox["2", "6"], "]"}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6243472939841347`*^9, 3.6243472944642487`*^9}, {
  3.6243494377282267`*^9, 3.624349451105096*^9}, {3.624349849379607*^9, 
  3.6243498662756157`*^9}, {3.624372348425601*^9, 3.624372371280304*^9}, {
  3.624374783611514*^9, 3.6243747849192543`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], LineBox[CompressedData["
1:eJwt0TlLA1EUhuFBgtrFwkJESFwQIyLG3ai5JwuInaSyE1zASrEQLIQEEReE
jCKKiCju/gobi/wdO3ejM987MFye+eaec89M6/xqYanG87zE/x2sul6d95yo
lGeaUzywt2p4pcV60xp3WhtMcRI3Wq224SaLhOs0bjH1KuC49hdncZu9hw/m
cIf9BHSLuNM+wnwZd8luBXfbd5iv4R45to57NU9xA/epX2wTJ+1TB8L99hUw
uoUHNL9t40Gd39/BQ3yffTys+v4BHlF9V8ajOt/uIR6j/xFOqd7eMR7X94id
4Am9XznFk6pXPMNpnX/qHDvmvcCm/XWXcsn0fvWKPKP+kWvyjOaN3pBn1a/9
ljxrv+F8d+Q51Vu4J88p9x/I8/p/L4/kef7fk/sD3FDo5w==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 41.}, {0, 0.04882812499999997}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.8200000000000001, 0.8200000000000001}, {
   0.0009765624999999995, 0.0009765624999999995}}]], "Output",
 CellChangeTimes->{
  3.62434729483988*^9, {3.624349438251013*^9, 3.6243494520859833`*^9}, {
   3.624349849716956*^9, 3.6243498665727386`*^9}, 3.6243709065820932`*^9, {
   3.624372352185495*^9, 3.624372371851633*^9}, {3.624374764564316*^9, 
   3.624374785631609*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 1015},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 259, 8, 123, "Section"],
Cell[CellGroupData[{
Cell[863, 34, 142, 1, 67, "Subsection"],
Cell[1008, 37, 1520, 37, 211, "Input"],
Cell[2531, 76, 2024, 50, 227, "Input"],
Cell[4558, 128, 675, 15, 77, "Input"],
Cell[CellGroupData[{
Cell[5258, 147, 598, 15, 77, "Input"],
Cell[5859, 164, 1433, 29, 339, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7329, 198, 612, 14, 77, "Input"],
Cell[7944, 214, 980, 15, 46, "Output"]
}, Open  ]],
Cell[8939, 232, 7413, 173, 427, "Input"],
Cell[CellGroupData[{
Cell[16377, 409, 494, 10, 52, "Input"],
Cell[16874, 421, 1973, 38, 346, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18884, 464, 291, 8, 52, "Input"],
Cell[19178, 474, 113, 1, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19328, 480, 208, 5, 46, "Input"],
Cell[19539, 487, 1755, 35, 351, "Output"]
}, Open  ]],
Cell[21309, 525, 7393, 172, 427, "Input"],
Cell[CellGroupData[{
Cell[28727, 701, 475, 10, 52, "Input"],
Cell[29205, 713, 1149, 24, 389, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
